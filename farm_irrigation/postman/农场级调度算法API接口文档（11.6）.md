# å†œåœºçº§çŒæº‰è°ƒåº¦ç®—æ³•APIæ¥å£æ–‡æ¡£-First

## ç›®å½•
1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [ä¸šåŠ¡æœ¯è¯­è¡¨](#ä¸šåŠ¡æœ¯è¯­è¡¨)
3. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
4. [è®¤è¯æ–¹å¼](#è®¤è¯æ–¹å¼)
5. [æ¥å£åˆ—è¡¨](#æ¥å£åˆ—è¡¨)
   - [ç³»ç»Ÿç®¡ç†](#1-ç³»ç»Ÿç®¡ç†)
   - [çŒæº‰è®¡åˆ’ç”Ÿæˆ](#2-çŒæº‰è®¡åˆ’ç”Ÿæˆ)
   - [å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”](#3-å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”)
   - [è®¡åˆ’ä¼˜åŒ–](#4-è®¡åˆ’ä¼˜åŒ–)
   - [åŠ¨æ€æ‰§è¡Œç®¡ç†](#5-åŠ¨æ€æ‰§è¡Œç®¡ç†)
   - [æ‰¹æ¬¡ç®¡ç†](#6-æ‰¹æ¬¡ç®¡ç†)
   - [æ°´ä½ç®¡ç†](#7-æ°´ä½ç®¡ç†)
   - [è®¡åˆ’é‡æ–°ç”Ÿæˆ](#8-è®¡åˆ’é‡æ–°ç”Ÿæˆ)
   - [æ‰¹æ¬¡é—´ç”°å—è°ƒæ•´](#9-æ‰¹æ¬¡é—´ç”°å—è°ƒæ•´)
6. [å…¸å‹ä¸šåŠ¡æµç¨‹](#å…¸å‹ä¸šåŠ¡æµç¨‹)
7. [é”™è¯¯ç è¯´æ˜](#é”™è¯¯ç è¯´æ˜)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---
## æ¦‚è¿°
### ç³»ç»Ÿä»‹ç»
å†œåœºçº§çŒæº‰è°ƒåº¦ç®—æ³•æä¾›ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š
- **åŠ¨æ€æ‰¹æ¬¡æ‰§è¡Œç®¡ç†** - å®æ—¶è°ƒæ•´çŒæº‰è®¡åˆ’
- **å®æ—¶æ°´ä½æ•°æ®è·å–å’Œç®¡ç†** - æ”¯æŒå¤šæ•°æ®æº
- **æ™ºèƒ½è®¡åˆ’é‡æ–°ç”Ÿæˆ** - åŸºäºæœ€æ–°æ•°æ®è‡ªåŠ¨ä¼˜åŒ–
- **æ‰§è¡ŒçŠ¶æ€ç›‘æ§å’Œå†å²è®°å½•** - å®Œæ•´çš„è¿½è¸ªä½“ç³»
- **ç”°å—æ°´ä½è¶‹åŠ¿åˆ†æ** - æ•°æ®å¯è§†åŒ–æ”¯æŒ
- **å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”åˆ†æ** - è¾…åŠ©å†³ç­–
- **çŒæº‰è®¡åˆ’æ™ºèƒ½ä¼˜åŒ–** - å¤šç›®æ ‡ä¼˜åŒ–ç®—æ³•

### æŠ€æœ¯æ¶æ„
- **æ¡†æ¶**: FastAPI + Uvicorn
- **éƒ¨ç½²**: Docker + Docker Compose + Nginx
- **ç«¯å£**: 80 (Nginx) / 8000 (APIç›´è¿)
---

## ä¸šåŠ¡æœ¯è¯­è¡¨

### æ ¸å¿ƒæ¦‚å¿µ
| æœ¯è¯­ | è‹±æ–‡ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|------|------|------|--------|
| **farm_id** | Farm ID | å†œåœºå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„å†œåœº | `"13944136728576"` |
| **plan_id** | Plan ID | çŒæº‰è®¡åˆ’æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œç”±ç”Ÿæˆè®¡åˆ’æ¥å£è¿”å› | `"/app/output/irrigation_plan_20250109_123456.json"` |
| **execution_id** | Execution ID | æ‰§è¡Œä»»åŠ¡çš„å”¯ä¸€æ ‡è¯†ï¼Œç”±å¯åŠ¨æ‰§è¡Œæ¥å£è¿”å› | `"exec_20250109_123456"` |
| **batch_index** | Batch Index | æ‰¹æ¬¡ç´¢å¼•å·ï¼Œ**ä»1å¼€å§‹è®¡æ•°**ï¼ˆä¸æ˜¯0ï¼‰ | `1, 2, 3, 4` |
| **field_id** | Field ID | ç”°å—å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œæ ¼å¼ï¼š`ç‰‡åŒº-é—¸é—¨-ç”°å—` | `"S3-G2-F1"` |
| **segment_id** | Segment ID | ç‰‡åŒºæ ‡è¯†ç¬¦ï¼Œè¡¨ç¤ºä¸€ä¸ªçŒæº‰åŒºåŸŸ | `"S3", "S4", "S5"` |

### çŒæº‰ç›¸å…³
| æœ¯è¯­ | è‹±æ–‡ | è¯´æ˜ | å•ä½ |
|------|------|------|------|
| **wl_mm** | Current Water Level | ç”°å—å½“å‰å®é™…æ°´ä½æ·±åº¦ | æ¯«ç±³ (mm) |
| **wl_low** | Low Water Level | ä½æ°´ä½é˜ˆå€¼ï¼Œ**è§¦å‘çŒæº‰çš„åˆ¤æ–­æ ‡å‡†** | æ¯«ç±³ (mm) |
| **wl_opt** | Optimal Water Level | æœ€ä¼˜æ°´ä½ï¼Œ**çŒæº‰çš„ç›®æ ‡æ°´ä½** | æ¯«ç±³ (mm) |
| **wl_high** | High Water Level | é«˜æ°´ä½é˜ˆå€¼ï¼Œè¶…è¿‡åˆ™ä¸éœ€è¦çŒæº‰ | æ¯«ç±³ (mm) |
| **d_target_mm** | Target Irrigation Depth | ç›®æ ‡çŒæº‰æ°´æ·±ï¼ˆå‚è€ƒå€¼ï¼Œå®é™…ä½¿ç”¨åŠ¨æ€è®¡ç®—ï¼‰ | æ¯«ç±³ (mm) |
| **area_mu** | Area | ç”°å—é¢ç§¯ | äº© (mu) |
| **deficit_vol_m3** | Deficit Volume | **åŠ¨æ€è®¡ç®—çš„ç¼ºæ°´é‡**ï¼ˆ= ç”°å—æ•°é‡ Ã— ç¼ºæ°´æ·±åº¦ Ã— 0.666667ï¼‰ | ç«‹æ–¹ç±³ (mÂ³) |
| **eta_hours** | ETA Hours | é¢„è®¡å®Œæˆæ—¶é—´ï¼ˆåŸºäºå®é™…ç¼ºæ°´é‡åŠ¨æ€è®¡ç®—ï¼‰ | å°æ—¶ (h) |

**ğŸ’¡ çŒæº‰é‡åŠ¨æ€è®¡ç®—é€»è¾‘ï¼š**
```
åˆ¤æ–­æ¡ä»¶ï¼šif wl_mm < wl_low â†’ éœ€è¦çŒæº‰
ç¼ºæ°´æ·±åº¦ï¼šdeficit_mm = wl_opt - wl_mm
ç¼ºæ°´é‡ï¼šdeficit_m3 = area_mu Ã— deficit_mm Ã— 0.666667
çŒæº‰ç›®æ ‡ï¼šä»å½“å‰æ°´ä½ (wl_mm) çŒæº‰åˆ°æœ€ä¼˜æ°´ä½ (wl_opt)
```

**ç¤ºä¾‹ï¼š**
- ç”°å—é¢ç§¯ = 10äº©
- wl_low = 80mm, wl_opt = 100mm
- å½“å‰æ°´ä½ = 75mm

```
åˆ¤æ–­ï¼š75 < 80 âœ… éœ€è¦çŒæº‰
ç¼ºæ°´æ·±åº¦ï¼š100 - 75 = 25mm
ç¼ºæ°´é‡ï¼š10 Ã— 25 Ã— 0.666667 = 167 mÂ³
çŒæº‰åï¼š75 + 25 = 100mm (è¾¾åˆ°æœ€ä¼˜æ°´ä½)
```

### è®¾å¤‡ç›¸å…³
| æœ¯è¯­ | è‹±æ–‡ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|------|------|------|--------|
| **pump_id** | Pump ID | æ°´æ³µæ ‡è¯†ç¬¦ | `"P1", "P2"` |
| **active_pumps** | Active Pumps | å½“å‰å¯ç”¨çš„æ°´æ³µåˆ—è¡¨ | `["P1", "P2"]` |
| **q_avail_m3ph** | Available Flow | å¯ç”¨æµé‡ï¼ˆæ¯å°æ—¶ç«‹æ–¹ç±³ï¼‰ | `240.0` |
| **power_kw** | Power | æ°´æ³µåŠŸç‡ | åƒç“¦ (kW) |

### æ—¶é—´ç›¸å…³
| æœ¯è¯­ | è‹±æ–‡ | è¯´æ˜ | æ ¼å¼/å•ä½ |
|------|------|------|----------|
| **t_start_h** | Start Time | å¼€å§‹æ—¶é—´ï¼ˆç›¸å¯¹æ—¶é—´ï¼‰ | å°æ—¶ (h)ï¼Œå¦‚ `22.0` è¡¨ç¤ºæ™šä¸Š10ç‚¹ |
| **t_end_h** | End Time | ç»“æŸæ—¶é—´ï¼ˆç›¸å¯¹æ—¶é—´ï¼‰ | å°æ—¶ (h)ï¼Œå¦‚ `40.28` è¡¨ç¤ºä»èµ·å§‹ç‚¹å40.28å°æ—¶ |
| **duration_h** | Duration | æŒç»­æ—¶é•¿ | å°æ—¶ (h) |
| **timestamp** | Timestamp | ç»å¯¹æ—¶é—´æˆ³ | ISO 8601æ ¼å¼ï¼Œå¦‚ `"2025-01-09T12:34:56.789Z"` |

### ä¼˜åŒ–ç›¸å…³
| æœ¯è¯­ | è‹±æ–‡ | è¯´æ˜ |
|------|------|------|
| **cost_minimization** | Cost Minimization | æˆæœ¬æœ€å°åŒ–ï¼Œä¼˜å…ˆé™ä½ç”µè´¹æˆæœ¬ |
| **time_minimization** | Time Minimization | æ—¶é—´æœ€å°åŒ–ï¼Œæœ€å¿«å®ŒæˆçŒæº‰ä»»åŠ¡ |
| **balanced** | Balanced | å‡è¡¡ä¼˜åŒ–ï¼Œåœ¨æˆæœ¬å’Œæ—¶é—´ä¹‹é—´å¹³è¡¡ |
| **off_peak** | Off-Peak | é¿å³°ç”¨ç”µï¼Œé¿å¼€å³°æ®µç”µä»·æ—¶æ®µ |
| **water_saving** | Water Saving | èŠ‚æ°´ä¼˜åŒ–ï¼Œå‡å°‘æ°´èµ„æºæ¶ˆè€— |

### æ‰§è¡Œæ¨¡å¼
| æ¨¡å¼ | è¯´æ˜ |
|------|------|
| **simulation** | æ¨¡æ‹Ÿæ¨¡å¼ï¼Œä¸å®é™…æ§åˆ¶è®¾å¤‡ï¼Œä»…ç”¨äºæµ‹è¯•å’Œé¢„è§ˆ |
| **production** | ç”Ÿäº§æ¨¡å¼ï¼Œå®é™…æ§åˆ¶çŒæº‰è®¾å¤‡æ‰§è¡Œ |

### æ•°æ®è´¨é‡
| ç­‰çº§ | è¯´æ˜ |
|------|------|
| **good** | è‰¯å¥½ï¼Œæ•°æ®æ¥è‡ªå¯é ä¼ æ„Ÿå™¨æˆ–ç»è¿‡éªŒè¯ |
| **fair** | ä¸€èˆ¬ï¼Œæ•°æ®å¯ç”¨ä½†å¯èƒ½å­˜åœ¨åå·® |
| **poor** | è¾ƒå·®ï¼Œæ•°æ®è´¨é‡ä¸ä½³ï¼Œå»ºè®®è°¨æ…ä½¿ç”¨ |

### æ•°æ®æ¥æº
| æ¥æº | è¯´æ˜ |
|------|------|
| **sensor** | ä¼ æ„Ÿå™¨è‡ªåŠ¨é‡‡é›† |
| **manual** | äººå·¥æ‰‹åŠ¨è¾“å…¥ |
| **estimated** | ç³»ç»Ÿä¼°ç®—å€¼ |

---

## å¿«é€Ÿå¼€å§‹

### åŸºç¡€é…ç½®

```javascript
// ç¯å¢ƒé…ç½®
const BASE_URL = 'http://120.55.127.125';
const API_BASE_URL = `${BASE_URL}/api`;

// é€šç”¨è¯·æ±‚å¤´
const headers = {
  'Content-Type': 'application/json',
  'Accept': 'application/json'
};
```

### æœ€ç®€å•çš„è°ƒç”¨ç¤ºä¾‹
```javascript
// 1. å¥åº·æ£€æŸ¥
fetch(`${BASE_URL}/api/system/health-check`, {
  method: 'POST',
  headers: headers
})
.then(res => res.json())
.then(data => console.log(data));

// 2. è·å–APIä¿¡æ¯
fetch(`${BASE_URL}/api/info`)
.then(res => res.json())
.then(data => console.log(data));
```

---
## è®¤è¯æ–¹å¼

**å½“å‰ç‰ˆæœ¬**: æ— éœ€è®¤è¯  
**æœªæ¥ç‰ˆæœ¬**: å°†æ”¯æŒ JWT Token è®¤è¯

```javascript
// é¢„ç•™çš„è®¤è¯å¤´ï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰
headers: {
  'Authorization': 'Bearer YOUR_JWT_TOKEN'
}
```

---

## æ¥å£åˆ—è¡¨

### 1. ç³»ç»Ÿç®¡ç†

#### 1.1 å¥åº·æ£€æŸ¥

**æ¥å£è¯´æ˜**: æ£€æŸ¥ç³»ç»Ÿå„ç»„ä»¶çš„å¥åº·çŠ¶æ€

**è¯·æ±‚**
```
POST /api/system/health-check
```

**å“åº”ç¤ºä¾‹**
```json
{
  "status": "healthy",
  "timestamp": "2025-01-09T12:34:56.789Z",
  "components": {
    "scheduler": "ok",
    "waterlevel_manager": "ok",
    "plan_regenerator": "ok",
    "status_manager": "ok"
  }
}
```

**å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| status | string | ç³»ç»Ÿæ€»ä½“çŠ¶æ€: `healthy`/`degraded`/`unhealthy` |
| timestamp | string | ISO 8601 æ ¼å¼æ—¶é—´æˆ³ |
| components | object | å„ç»„ä»¶çŠ¶æ€ï¼Œå€¼ä¸º `ok`/`not_initialized` |

---

#### 1.2 è·å–ç³»ç»ŸçŠ¶æ€

**æ¥å£è¯´æ˜**: è·å–ç³»ç»Ÿè¿è¡ŒçŠ¶æ€å’Œç»„ä»¶åˆå§‹åŒ–æƒ…å†µ

**è¯·æ±‚**
```
GET /api/system/status
```

**å“åº”ç¤ºä¾‹**
```json
{
  "system_status": "running",
  "scheduler_initialized": true,
  "waterlevel_manager_initialized": true,
  "plan_regenerator_initialized": true,
  "status_manager_initialized": true,
  "current_time": "2025-01-09T12:34:56.789Z",
  "uptime_seconds": 3600.5
}
```

---

#### 1.3 è·å–APIä¿¡æ¯

**æ¥å£è¯´æ˜**: è·å–APIç‰ˆæœ¬å’ŒåŠŸèƒ½åˆ—è¡¨

**è¯·æ±‚**
```
GET /api/info
```

**å“åº”ç¤ºä¾‹**
```json
{
  "title": "æ™ºèƒ½çŒæº‰åŠ¨æ€æ‰§è¡Œç³»ç»ŸAPI",
  "description": "åŸºäºå®æ—¶æ°´ä½æ•°æ®çš„æ™ºèƒ½çŒæº‰æ‰¹æ¬¡åŠ¨æ€æ‰§è¡Œç³»ç»Ÿ",
  "version": "1.0.0",
  "features": [
    "åŠ¨æ€æ‰¹æ¬¡æ‰§è¡Œç®¡ç†",
    "å®æ—¶æ°´ä½æ•°æ®è·å–å’Œç®¡ç†",
    "æ™ºèƒ½è®¡åˆ’é‡æ–°ç”Ÿæˆ",
    "æ‰§è¡ŒçŠ¶æ€ç›‘æ§å’Œå†å²è®°å½•",
    "ç”°å—æ°´ä½è¶‹åŠ¿åˆ†æ",
    "å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”åˆ†æ",
    "çŒæº‰è®¡åˆ’æ™ºèƒ½ä¼˜åŒ–"
  ],
  "endpoints": {
    "system": "/api/system/*",
    "execution": "/api/execution/*",
    "water_levels": "/api/water-levels/*",
    "regeneration": "/api/regeneration/*",
    "batches": "/api/batches/*",
    "irrigation": "/api/irrigation/*",
    "data": "/api/data/*"
  }
}
```

---

### 2. çŒæº‰è®¡åˆ’ç”Ÿæˆ

#### 2.1 ç”ŸæˆçŒæº‰è®¡åˆ’

**æ¥å£è¯´æ˜**: æ ¹æ®é…ç½®ç”Ÿæˆå®Œæ•´çš„çŒæº‰è®¡åˆ’ï¼Œæ”¯æŒå¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”

**è¯·æ±‚**
```
POST /api/irrigation/plan-generation
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "farm_id": "13944136728576",
  "config_path": "",
  "output_dir": "",
  "scenario_name": "test_scenario",
  "multi_pump_scenarios": true
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| farm_id | string | âœ… æ˜¯ | - | å†œåœºå”¯ä¸€æ ‡è¯†ç¬¦ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æ ‡è¯†å½“å‰æ“ä½œçš„å†œåœºï¼Œç³»ç»Ÿæ ¹æ®æ­¤IDåŠ è½½å¯¹åº”çš„å†œåœºé…ç½®å’Œç”°å—æ•°æ®ã€‚<br>**ç¤ºä¾‹**: `"13944136728576"` |
| config_path | string | âŒ å¦ | `"config.json"` | é…ç½®æ–‡ä»¶è·¯å¾„ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æŒ‡å®šè‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œç•™ç©ºåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤é…ç½®æ–‡ä»¶ã€‚é…ç½®æ–‡ä»¶åŒ…å«æ°´æ³µå‚æ•°ã€ç”µä»·ã€çŒæº‰æ·±åº¦ç­‰è®¾ç½®ã€‚<br>**ç¤ºä¾‹**: `""` (ä½¿ç”¨é»˜è®¤) æˆ– `"custom_config.json"` |
| output_dir | string | âŒ å¦ | `"/app/output"` | è¾“å‡ºç›®å½•è·¯å¾„ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: çŒæº‰è®¡åˆ’æ–‡ä»¶çš„ä¿å­˜ç›®å½•ï¼Œç•™ç©ºåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤è¾“å‡ºç›®å½•ã€‚<br>**ç¤ºä¾‹**: `""` (ä½¿ç”¨é»˜è®¤) æˆ– `"/custom/path"` |
| scenario_name | string | âŒ å¦ | `"default"` | åœºæ™¯åç§°æ ‡è¯†ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ä¸ºæœ¬æ¬¡ç”Ÿæˆçš„è®¡åˆ’å‘½åï¼Œä¾¿äºåç»­è¯†åˆ«å’Œç®¡ç†ä¸åŒåœºæ™¯çš„æ–¹æ¡ˆï¼ˆå¦‚"å¤å­£çŒæº‰"ã€"åº”æ€¥æ–¹æ¡ˆ"ç­‰ï¼‰ã€‚<br>**ç¤ºä¾‹**: `"test_scenario"`, `"summer_plan"` |
| multi_pump_scenarios | boolean | âŒ å¦ | `false` | æ˜¯å¦ç”Ÿæˆå¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: å¯ç”¨åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸åŒæ°´æ³µç»„åˆçš„æ–¹æ¡ˆï¼ˆå¦‚P1å•ç‹¬ã€P2å•ç‹¬ã€P1+P2ç»„åˆï¼‰ï¼Œå¹¶è¿›è¡Œæˆæœ¬å’Œæ—¶é•¿å¯¹æ¯”ï¼Œå¸®åŠ©å†³ç­–é€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆã€‚<br>**å»ºè®®**: é¦–æ¬¡è§„åˆ’æˆ–éœ€è¦å¯¹æ¯”æ—¶è®¾ä¸º`true`ã€‚<br>**ç¤ºä¾‹**: `true` |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "message": "çŒæº‰è®¡åˆ’ç”ŸæˆæˆåŠŸ",
  "plan_id": "/app/output/irrigation_plan_20250109_123456.json",
  "data": {
    "calc": {
      "A_cover_mu": 79.99996,
      "q_avail_m3ph": 240.0,
      "t_win_h": 20.0,
      "d_target_mm": 90.0
    },
    "batches": [
      {
        "index": 1,
        "area_mu": 73.107,
        "fields": [
          {
            "id": "S3-G2-F1",
            "area_mu": 5.225,
            "segment_id": "S3",
            "wl_mm": 0.0
          }
        ],
        "stats": {
          "deficit_vol_m3": 4386.42,
          "cap_vol_m3": 4800.0,
          "eta_hours": 18.28
        }
      }
    ],
    "steps": [
      {
        "t_start_h": 22.0,
        "t_end_h": 40.28,
        "label": "æ‰¹æ¬¡ 1",
        "commands": [
          {
            "action": "start",
            "target": "P2",
            "value": null,
            "t_start_h": 22.0,
            "t_end_h": 40.28
          }
        ]
      }
    ]
  },
  "multi_pump_scenarios": {
    "scenarios": [
      {
        "scenario_name": "P2å•ç‹¬ä½¿ç”¨",
        "pumps_used": ["P2"],
        "total_electricity_cost": 1774.17,
        "total_eta_h": 73.92,
        "coverage_info": {
          "covered_segments": ["S3", "S4", "S5", "S6", "S7", "S8"],
          "total_covered_segments": 6
        }
      }
    ],
    "analysis": {
      "total_fields_below_threshold": 36,
      "min_fields_trigger": 1,
      "trigger_status": "å·²è¾¾åˆ°è§¦å‘æ¡ä»¶"
    },
    "total_scenarios": 4
  }
}
```

**å…³é”®å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| plan_id | string | **é‡è¦ï¼** ç”Ÿæˆçš„è®¡åˆ’æ–‡ä»¶å®Œæ•´è·¯å¾„ï¼Œç”¨äºåç»­æ¥å£ |
| data.batches | array | çŒæº‰æ‰¹æ¬¡åˆ—è¡¨ |
| data.steps | array | æ‰§è¡Œæ­¥éª¤åˆ—è¡¨ |
| multi_pump_scenarios | object | å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”æ•°æ®ï¼ˆå¦‚æœå¯ç”¨ï¼‰ |

---

#### 2.2 ä¸Šä¼ é…ç½®å¹¶ç”Ÿæˆè®¡åˆ’

**æ¥å£è¯´æ˜**: ä¸Šä¼ è‡ªå®šä¹‰é…ç½®æ–‡ä»¶å¹¶ç”ŸæˆçŒæº‰è®¡åˆ’

**è¯·æ±‚**
```
POST /api/irrigation/plan-with-upload
Content-Type: multipart/form-data
```

**è¯·æ±‚å‚æ•° (FormData)**
```javascript
const formData = new FormData();
formData.append('farm_id', '13944136728576');
formData.append('scenario_name', 'upload_test');
formData.append('multi_pump_scenarios', 'true');
formData.append('config_file', fileBlob, 'config.json');
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| farm_id | string | æ˜¯ | å†œåœºID |
| scenario_name | string | å¦ | åœºæ™¯åç§° |
| multi_pump_scenarios | string | å¦ | "true"/"false" |
| config_file | file | å¦ | é…ç½®JSONæ–‡ä»¶ |

**å“åº”æ ¼å¼**: ä¸æ¥å£2.1ç›¸åŒ

---

### 3. å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”

#### 3.1 ç”Ÿæˆå¤šæ°´æ³µæ–¹æ¡ˆ

**æ¥å£è¯´æ˜**: ç‹¬ç«‹ç”Ÿæˆå¤šä¸ªæ°´æ³µç»„åˆçš„çŒæº‰æ–¹æ¡ˆï¼Œç”¨äºæ–¹æ¡ˆå¯¹æ¯”å’Œå†³ç­–

**è¯·æ±‚**
```
POST /api/irrigation/multi-pump-scenarios
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "config_file": "config.json",
  "active_pumps": null,
  "zone_ids": null,
  "use_realtime_wl": true,
  "min_fields_trigger": 1
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| config_file | string | âœ… æ˜¯ | - | é…ç½®æ–‡ä»¶åç§°ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼ŒåŒ…å«å†œåœºå¸ƒå±€ã€æ°´æ³µå‚æ•°ã€ç”µä»·ç­‰åŸºç¡€æ•°æ®ã€‚<br>**ç¤ºä¾‹**: `"config.json"` |
| active_pumps | array\|null | âŒ å¦ | `null` | æŒ‡å®šå‚ä¸å¯¹æ¯”çš„æ°´æ³µåˆ—è¡¨ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: é™åˆ¶å¯¹æ¯”æ–¹æ¡ˆä¸­ä½¿ç”¨çš„æ°´æ³µï¼Œ`null`è¡¨ç¤ºä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰å¯ç”¨æ°´æ³µã€‚å¯ç”¨äºæ¨¡æ‹ŸæŸå°æ°´æ³µæ•…éšœæ—¶çš„å¤‡ç”¨æ–¹æ¡ˆã€‚<br>**ç¤ºä¾‹**: `["P1", "P2"]` æˆ– `null` (å…¨éƒ¨æ°´æ³µ) |
| zone_ids | array\|null | âŒ å¦ | `null` | æŒ‡å®šçŒæº‰çš„ç‰‡åŒºåˆ—è¡¨ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: é™åˆ¶åªå¯¹æŒ‡å®šç‰‡åŒºç”Ÿæˆæ–¹æ¡ˆï¼Œ`null`è¡¨ç¤ºè¦†ç›–æ‰€æœ‰éœ€è¦çŒæº‰çš„ç‰‡åŒºã€‚å¯ç”¨äºåˆ†åŒºåŸŸçŒæº‰è§„åˆ’ã€‚<br>**ç¤ºä¾‹**: `["S3", "S4"]` æˆ– `null` (å…¨éƒ¨ç‰‡åŒº) |
| use_realtime_wl | boolean | âŒ å¦ | `true` | æ˜¯å¦ä½¿ç”¨å®æ—¶æ°´ä½æ•°æ®ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: `true`ä»æ°´ä½ç®¡ç†ç³»ç»Ÿè·å–æœ€æ–°æ•°æ®ï¼Œ`false`ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„é»˜è®¤æ°´ä½ã€‚å»ºè®®å¼€å¯ä»¥è·å¾—å‡†ç¡®çš„çŒæº‰æ–¹æ¡ˆã€‚<br>**ç¤ºä¾‹**: `true` |
| min_fields_trigger | integer\|null | âŒ å¦ | `null` | è§¦å‘çŒæº‰çš„æœ€å°ç”°å—æ•°é˜ˆå€¼ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: åªæœ‰å½“ä½äºç›®æ ‡æ°´ä½çš„ç”°å—æ•°é‡ â‰¥ æ­¤å€¼æ—¶ï¼Œæ‰ç”ŸæˆçŒæº‰æ–¹æ¡ˆã€‚`null`ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„é»˜è®¤å€¼ã€‚å¯ç”¨äºé¿å…ä¸ºå°‘é‡ç”°å—å¯åŠ¨å¤§å‹æ°´æ³µã€‚<br>**ç¤ºä¾‹**: `1` (æœ‰1å—ç”°éœ€è¦å°±çŒæº‰) æˆ– `5` (è‡³å°‘5å—ç”°éœ€è¦æ‰çŒæº‰) |

**å“åº”ç¤ºä¾‹**
```json
{
  "scenarios": [
    {
      "scenario_name": "P1å•ç‹¬ä½¿ç”¨",
      "pumps_used": ["P1"],
      "total_electricity_cost": 2150.5,
      "total_eta_h": 85.3,
      "total_pump_runtime_hours": {
        "P1": 70.2
      },
      "coverage_info": {
        "covered_segments": ["S1", "S2"],
        "total_covered_segments": 2
      },
      "plan": {
        "batches": [],
        "steps": []
      }
    },
    {
      "scenario_name": "P2å•ç‹¬ä½¿ç”¨",
      "pumps_used": ["P2"],
      "total_electricity_cost": 1774.17,
      "total_eta_h": 73.92,
      "coverage_info": {
        "covered_segments": ["S3", "S4", "S5", "S6", "S7", "S8"],
        "total_covered_segments": 6
      }
    },
    {
      "scenario_name": "P1+P2ç»„åˆ",
      "pumps_used": ["P1", "P2"],
      "total_electricity_cost": 1950.8,
      "total_eta_h": 65.5,
      "coverage_info": {
        "covered_segments": ["S1", "S2", "S3", "S4", "S5", "S6", "S7", "S8"],
        "total_covered_segments": 8
      }
    }
  ],
  "analysis": {
    "total_fields_below_threshold": 36,
    "min_fields_trigger": 1,
    "trigger_status": "å·²è¾¾åˆ°è§¦å‘æ¡ä»¶",
    "total_fields_to_irrigate": 36,
    "required_segments": ["S3", "S4", "S5", "S6", "S7", "S8"],
    "valid_pump_combinations": [["P2"], ["P1", "P2"]]
  },
  "total_scenarios": 3
}
```

**å…³é”®å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| scenarios | array | æ‰€æœ‰å¯è¡Œæ–¹æ¡ˆåˆ—è¡¨ |
| scenarios[].total_electricity_cost | number | æ€»ç”µè´¹ï¼ˆå…ƒï¼‰ |
| scenarios[].total_eta_h | number | æ€»æ—¶é•¿ï¼ˆå°æ—¶ï¼‰ |
| scenarios[].pumps_used | array | ä½¿ç”¨çš„æ°´æ³µåˆ—è¡¨ |
| analysis.trigger_status | string | è§¦å‘æ¡ä»¶çŠ¶æ€ |
| analysis.valid_pump_combinations | array | æœ‰æ•ˆçš„æ°´æ³µç»„åˆ |

---

### 4. è®¡åˆ’ä¼˜åŒ–

#### 4.1 æ™ºèƒ½ä¼˜åŒ–çŒæº‰è®¡åˆ’

**æ¥å£è¯´æ˜**: åŸºäºä¸åŒä¼˜åŒ–ç›®æ ‡ç”Ÿæˆå¤šä¸ªä¼˜åŒ–æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æˆæœ¬æœ€å°åŒ–ã€æ—¶é—´æœ€å°åŒ–ã€å‡è¡¡ä¼˜åŒ–ã€é¿å³°ç”¨ç”µç­‰

**è¯·æ±‚**
```
POST /api/irrigation/plan-optimization
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "original_plan_id": "/app/output/irrigation_plan_20250109_123456.json",
  "optimization_goals": [
    "cost_minimization",
    "time_minimization",
    "balanced",
    "off_peak"
  ],
  "constraints": {
    "max_duration_hours": 24,
    "electricity_price_schedule": {
      "peak": {
        "hours": [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21],
        "price": 1.0
      },
      "valley": {
        "hours": [22, 23, 0, 1, 2, 3, 4, 5, 6, 7],
        "price": 0.4
      }
    },
    "available_pumps": ["P1", "P2"]
  }
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| original_plan_id | string | âœ… æ˜¯ | - | åŸå§‹çŒæº‰è®¡åˆ’IDã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç”±"ç”ŸæˆçŒæº‰è®¡åˆ’"æ¥å£è¿”å›çš„`plan_id`ï¼Œä½œä¸ºä¼˜åŒ–çš„åŸºç¡€æ–¹æ¡ˆã€‚ç³»ç»Ÿä¼šåŸºäºæ­¤æ–¹æ¡ˆç”Ÿæˆå¤šä¸ªä¼˜åŒ–ç‰ˆæœ¬ã€‚<br>**æ¥æº**: `/api/irrigation/plan-generation` çš„å“åº”ä¸­çš„ `plan_id` å­—æ®µ<br>**ç¤ºä¾‹**: `"/app/output/irrigation_plan_20250109_123456.json"` |
| optimization_goals | array | âœ… æ˜¯ | - | ä¼˜åŒ–ç›®æ ‡åˆ—è¡¨ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æŒ‡å®šè¦ç”Ÿæˆçš„ä¼˜åŒ–æ–¹æ¡ˆç±»å‹ï¼Œå¯åŒæ—¶æŒ‡å®šå¤šä¸ªç›®æ ‡ï¼Œç³»ç»Ÿä¼šä¸ºæ¯ä¸ªç›®æ ‡ç”Ÿæˆä¸€ä¸ªç‹¬ç«‹æ–¹æ¡ˆã€‚<br>**å»ºè®®**: è‡³å°‘é€‰æ‹©2-3ä¸ªç›®æ ‡è¿›è¡Œå¯¹æ¯”<br>**ç¤ºä¾‹**: `["cost_minimization", "time_minimization", "balanced"]` |
| constraints | object | âŒ å¦ | `{}` | çº¦æŸæ¡ä»¶é…ç½®ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: é™åˆ¶ä¼˜åŒ–æ–¹æ¡ˆçš„è¾¹ç•Œæ¡ä»¶ï¼Œå¦‚æœ€å¤§æ—¶é•¿ã€ç”µä»·æ—¶æ®µã€å¯ç”¨æ°´æ³µç­‰ã€‚<br>**å­å­—æ®µ**:<br>â€¢ `max_duration_hours`: æœ€å¤§å…è®¸æ—¶é•¿ï¼ˆå°æ—¶ï¼‰<br>â€¢ `electricity_price_schedule`: ç”µä»·æ—¶æ®µè¡¨<br>â€¢ `available_pumps`: å¯ç”¨æ°´æ³µåˆ—è¡¨<br>**ç¤ºä¾‹**: è§ä¸‹æ–¹è¯¦ç»†è¯´æ˜ |

**optimization_goals å¯é€‰å€¼**

| å€¼ | åç§° | ä¸šåŠ¡ç›®æ ‡ | é€‚ç”¨åœºæ™¯ |
|---|------|----------|----------|
| `cost_minimization` | æˆæœ¬æœ€å°åŒ– | é™ä½ç”µè´¹æ”¯å‡ºï¼Œä¼˜å…ˆåœ¨ä½è°·ç”µä»·æ—¶æ®µçŒæº‰ | ç”µè´¹é¢„ç®—ç´§å¼ ï¼Œå¯¹æ—¶é—´è¦æ±‚ä¸é«˜ |
| `time_minimization` | æ—¶é—´æœ€å°åŒ– | æœ€å¿«å®Œæˆä»»åŠ¡ï¼Œä½¿ç”¨æœ€å¤§æ°´æ³µç»„åˆ | åº”æ€¥çŒæº‰ï¼Œå¤©æ°”æ¡ä»¶ç´§è¿« |
| `balanced` | å‡è¡¡ä¼˜åŒ– | åœ¨æˆæœ¬å’Œæ—¶é—´ä¹‹é—´å–å¾—å¹³è¡¡ | æ—¥å¸¸çŒæº‰ï¼Œç»¼åˆè€ƒè™‘æ•ˆç‡å’Œæˆæœ¬ |
| `off_peak` | é¿å³°ç”¨ç”µ | å®Œå…¨é¿å¼€å³°æ®µç”µä»·ï¼Œé™ä½ç”µè´¹ | æ‰§è¡Œåˆ†æ—¶ç”µä»·æ”¿ç­–çš„å†œåœº |
| `water_saving` | èŠ‚æ°´ä¼˜åŒ– | å‡å°‘æ°´èµ„æºæ¶ˆè€—ï¼Œæé«˜åˆ©ç”¨ç‡ | æ°´èµ„æºç´§å¼ åœ°åŒº |

**constraints è¯¦ç»†è¯´æ˜**

| å­å‚æ•° | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `max_duration_hours` | number | æœ€å¤§å…è®¸æ‰§è¡Œæ—¶é•¿ï¼ˆå°æ—¶ï¼‰ã€‚è¶…è¿‡æ­¤æ—¶é•¿çš„æ–¹æ¡ˆä¼šè¢«è¿‡æ»¤ã€‚<br>**ç¤ºä¾‹**: `24` (å¿…é¡»åœ¨24å°æ—¶å†…å®Œæˆ) |
| `electricity_price_schedule` | object | ç”µä»·æ—¶æ®µé…ç½®ã€‚<br>**åŒ…å«**: `peak`(å³°æ®µ) å’Œ `valley`(è°·æ®µ)<br>**æ¯ä¸ªæ—¶æ®µåŒ…å«**: `hours`(å°æ—¶æ•°ç»„) å’Œ `price`(ç”µä»·)<br>**ç¤ºä¾‹**: `{"peak": {"hours": [8-21], "price": 1.0}, "valley": {"hours": [22-7], "price": 0.4}}` |
| `available_pumps` | array | å¯ç”¨æ°´æ³µåˆ—è¡¨ï¼Œé™åˆ¶åªä½¿ç”¨æŒ‡å®šæ°´æ³µã€‚<br>**ç¤ºä¾‹**: `["P1", "P2"]` |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "message": "æˆåŠŸç”Ÿæˆ 4 ä¸ªä¼˜åŒ–æ–¹æ¡ˆ",
  "total_scenarios": 4,
  "scenarios": [
    {
      "name": "æˆæœ¬æœ€å°åŒ–æ–¹æ¡ˆ",
      "description": "ä¼˜å…ˆé™ä½ç”µè´¹æˆæœ¬ï¼Œåœ¨ä½è°·ç”µä»·æ—¶æ®µé›†ä¸­çŒæº‰",
      "total_eta_h": 78.5,
      "total_electricity_cost": 1580.3,
      "optimization_type": "cost_minimization",
      "plan": {
        "batches": [],
        "steps": []
      }
    },
    {
      "name": "æ—¶é—´æœ€å°åŒ–æ–¹æ¡ˆ",
      "description": "æœ€å¿«å®ŒæˆçŒæº‰ä»»åŠ¡ï¼Œä½¿ç”¨æœ€å¤§æ³µç»„åˆ",
      "total_eta_h": 55.2,
      "total_electricity_cost": 2150.8,
      "optimization_type": "time_minimization"
    },
    {
      "name": "å‡è¡¡ä¼˜åŒ–æ–¹æ¡ˆ",
      "description": "åœ¨æˆæœ¬å’Œæ—¶é—´ä¹‹é—´å¯»æ±‚æœ€ä½³å¹³è¡¡",
      "total_eta_h": 65.8,
      "total_electricity_cost": 1820.5,
      "optimization_type": "balanced"
    },
    {
      "name": "é¿å³°ç”¨ç”µæ–¹æ¡ˆ",
      "description": "å®Œå…¨é¿å¼€å³°æ®µç”µä»·æ—¶æ®µ",
      "total_eta_h": 82.3,
      "total_electricity_cost": 1620.7,
      "optimization_type": "off_peak"
    }
  ],
  "comparison": {
    "recommended": "æˆæœ¬æœ€å°åŒ–æ–¹æ¡ˆ",
    "cost_range": {
      "min": 1580.3,
      "max": 2150.8,
      "savings_percent": 26.5
    },
    "time_range": {
      "min": 55.2,
      "max": 82.3
    }
  },
  "base_plan_summary": {
    "total_eta_h": 73.92,
    "total_electricity_cost": 1774.17,
    "total_batches": 4
  }
}
```

**å…³é”®å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| scenarios | array | ä¼˜åŒ–æ–¹æ¡ˆåˆ—è¡¨ |
| scenarios[].name | string | æ–¹æ¡ˆåç§° |
| scenarios[].description | string | æ–¹æ¡ˆæè¿° |
| scenarios[].total_eta_h | number | æ€»æ—¶é•¿ï¼ˆå°æ—¶ï¼‰ |
| scenarios[].total_electricity_cost | number | æ€»ç”µè´¹ï¼ˆå…ƒï¼‰ |
| comparison.recommended | string | æ¨èæ–¹æ¡ˆ |
| comparison.cost_range.savings_percent | number | æœ€å¤§èŠ‚çœç™¾åˆ†æ¯” |

---

### 5. åŠ¨æ€æ‰§è¡Œç®¡ç†

#### 5.1 å¯åŠ¨åŠ¨æ€æ‰§è¡Œ

**æ¥å£è¯´æ˜**: å¯åŠ¨çŒæº‰è®¡åˆ’çš„åŠ¨æ€æ‰§è¡Œï¼Œæ”¯æŒå®æ—¶æ°´ä½æ›´æ–°å’Œè®¡åˆ’é‡æ–°ç”Ÿæˆ

**è¯·æ±‚**
```
POST /api/execution/start
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "plan_file_path": "/app/output/irrigation_plan_20250109_123456.json",
  "farm_id": "13944136728576",
  "config_file_path": "",
  "auto_start": true,
  "water_level_update_interval_minutes": 30,
  "enable_plan_regeneration": true,
  "execution_mode": "simulation"
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| plan_file_path | string | âœ… æ˜¯ | - | çŒæº‰è®¡åˆ’æ–‡ä»¶è·¯å¾„ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: è¦æ‰§è¡Œçš„çŒæº‰è®¡åˆ’ï¼Œä½¿ç”¨"ç”ŸæˆçŒæº‰è®¡åˆ’"æ¥å£è¿”å›çš„`plan_id`ã€‚<br>**é‡è¦**: å¿…é¡»ä½¿ç”¨å®Œæ•´è·¯å¾„ï¼Œç³»ç»Ÿä¼šæ ¹æ®æ­¤æ–‡ä»¶çš„æ‰¹æ¬¡ã€æ—¶é—´ã€è®¾å¤‡ä¿¡æ¯è¿›è¡Œæ‰§è¡Œè°ƒåº¦ã€‚<br>**æ¥æº**: `/api/irrigation/plan-generation` æˆ– `/api/irrigation/plan-optimization` çš„ `plan_id`<br>**ç¤ºä¾‹**: `"/app/output/irrigation_plan_20250109_123456.json"` |
| farm_id | string | âœ… æ˜¯ | - | å†œåœºå”¯ä¸€æ ‡è¯†ç¬¦ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: å¿…é¡»ä¸ç”Ÿæˆè®¡åˆ’æ—¶ä½¿ç”¨çš„`farm_id`ä¸€è‡´ï¼Œç”¨äºåŠ è½½å†œåœºé…ç½®å’ŒéªŒè¯è®¡åˆ’æœ‰æ•ˆæ€§ã€‚<br>**ç¤ºä¾‹**: `"13944136728576"` |
| config_file_path | string | âŒ å¦ | `"config.json"` | é…ç½®æ–‡ä»¶è·¯å¾„ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼ŒåŒ…å«è®¾å¤‡é€šä¿¡å‚æ•°ã€å®‰å…¨é˜ˆå€¼ç­‰ã€‚ç•™ç©ºä½¿ç”¨é»˜è®¤é…ç½®ã€‚<br>**ç¤ºä¾‹**: `""` (ä½¿ç”¨é»˜è®¤) |
| auto_start | boolean | âŒ å¦ | `true` | æ˜¯å¦ç«‹å³å¼€å§‹æ‰§è¡Œã€‚<br>**ä¸šåŠ¡å«ä¹‰**: <br>â€¢ `true`: å¯åŠ¨åç«‹å³æŒ‰è®¡åˆ’æ‰§è¡Œï¼Œé€‚åˆè‡ªåŠ¨åŒ–åœºæ™¯<br>â€¢ `false`: å¯åŠ¨åè¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œéœ€æ‰‹åŠ¨è§¦å‘ï¼Œé€‚åˆéœ€è¦äººå·¥ç¡®è®¤çš„åœºæ™¯<br>**å»ºè®®**: æµ‹è¯•æ—¶è®¾ä¸º`false`ï¼Œç”Ÿäº§ç¯å¢ƒå¯è®¾ä¸º`true`<br>**ç¤ºä¾‹**: `true` |
| water_level_update_interval_minutes | integer | âŒ å¦ | `30` | æ°´ä½æ•°æ®æ›´æ–°é—´éš”ï¼ˆåˆ†é’Ÿï¼‰ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç³»ç»Ÿæ¯éš”æ­¤æ—¶é•¿è‡ªåŠ¨è·å–æœ€æ–°æ°´ä½æ•°æ®ã€‚è®¾ç½®è¶Šå°æ•°æ®è¶ŠåŠæ—¶ï¼Œä½†ä¼šå¢åŠ ä¼ æ„Ÿå™¨è¯»å–é¢‘ç‡ã€‚<br>**å»ºè®®èŒƒå›´**: 15-60åˆ†é’Ÿ<br>**ç¤ºä¾‹**: `30` (æ¯30åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡) |
| enable_plan_regeneration | boolean | âŒ å¦ | `true` | æ˜¯å¦å¯ç”¨æ™ºèƒ½é‡æ–°ç”Ÿæˆã€‚<br>**ä¸šåŠ¡å«ä¹‰**: <br>â€¢ `true`: å½“æ°´ä½å˜åŒ–è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œè‡ªåŠ¨é‡æ–°ç”Ÿæˆåç»­æ‰¹æ¬¡è®¡åˆ’ï¼Œå®ç°åŠ¨æ€è°ƒæ•´<br>â€¢ `false`: ä¸¥æ ¼æŒ‰åŸè®¡åˆ’æ‰§è¡Œï¼Œä¸åšè°ƒæ•´<br>**é€‚ç”¨åœºæ™¯**: <br>â€¢ å¤©æ°”å¤šå˜ã€æ°´ä½æ³¢åŠ¨å¤§ â†’ è®¾ä¸º`true`<br>â€¢ è®¡åˆ’å·²ç»è¿‡å……åˆ†éªŒè¯ã€éœ€ä¸¥æ ¼æ‰§è¡Œ â†’ è®¾ä¸º`false`<br>**ç¤ºä¾‹**: `true` |
| execution_mode | string | âŒ å¦ | `"simulation"` | æ‰§è¡Œæ¨¡å¼ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: <br>â€¢ `simulation`: **æ¨¡æ‹Ÿæ¨¡å¼**ï¼Œä¸å®é™…æ§åˆ¶è®¾å¤‡ï¼Œä»…è®°å½•æ‰§è¡Œæ—¥å¿—ï¼Œç”¨äºæµ‹è¯•å’Œé¢„æ¼”<br>â€¢ `production`: **ç”Ÿäº§æ¨¡å¼**ï¼Œå®é™…å‘é€æŒ‡ä»¤æ§åˆ¶æ°´æ³µã€é—¸é—¨ç­‰è®¾å¤‡<br>**âš ï¸ é‡è¦**: é¦–æ¬¡éƒ¨ç½²æˆ–ä¿®æ”¹é…ç½®åï¼Œå¿…é¡»å…ˆåœ¨`simulation`æ¨¡å¼ä¸‹éªŒè¯ï¼<br>**ç¤ºä¾‹**: `"simulation"` (æµ‹è¯•) æˆ– `"production"` (æ­£å¼æ‰§è¡Œ) |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "message": "åŠ¨æ€æ‰§è¡Œå¯åŠ¨æˆåŠŸ",
  "data": {
    "execution_id": "exec_20250109_123456",
    "status": "running",
    "start_time": "2025-01-09T12:34:56.789Z",
    "plan_file": "/app/output/irrigation_plan_20250109_123456.json",
    "total_batches": 4,
    "current_batch": 1,
    "execution_mode": "simulation"
  }
}
```

**å…³é”®å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| execution_id | string | **é‡è¦ï¼** æ‰§è¡ŒIDï¼Œç”¨äºæŸ¥è¯¢çŠ¶æ€å’Œåœæ­¢æ‰§è¡Œ |
| status | string | æ‰§è¡ŒçŠ¶æ€: `running`/`paused`/`completed`/`failed` |
| current_batch | integer | å½“å‰æ‰§è¡Œæ‰¹æ¬¡ |
| total_batches | integer | æ€»æ‰¹æ¬¡æ•° |

---

#### 5.2 æŸ¥è¯¢æ‰§è¡ŒçŠ¶æ€

**æ¥å£è¯´æ˜**: æŸ¥è¯¢å½“å‰æ‰§è¡Œçš„è¯¦ç»†çŠ¶æ€

**è¯·æ±‚**
```
GET /api/execution/status?execution_id=exec_20250109_123456
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| execution_id | string | å¦ | æ‰§è¡ŒIDï¼Œä¸ä¼ è¿”å›å½“å‰æ‰§è¡Œ |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "execution_id": "exec_20250109_123456",
    "status": "running",
    "start_time": "2025-01-09T12:34:56.789Z",
    "current_batch": 2,
    "total_batches": 4,
    "progress_percent": 50.0,
    "last_water_level_update": "2025-01-09T13:04:56.789Z",
    "total_regenerations": 1,
    "active_fields": [
      {
        "field_id": "S4-G21-F15",
        "status": "irrigating",
        "start_time": "2025-01-09T13:00:00.000Z"
      }
    ],
    "completed_batches": [1],
    "selected_scenario": {
      "scenario_name": "P2å•ç‹¬ä½¿ç”¨",
      "pumps_used": ["P2"],
      "total_batches": 4
    }
  }
}
```

**å…³é”®å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| status | string | æ‰§è¡ŒçŠ¶æ€ |
| progress_percent | number | æ‰§è¡Œè¿›åº¦ç™¾åˆ†æ¯” |
| total_regenerations | integer | è®¡åˆ’é‡æ–°ç”Ÿæˆæ¬¡æ•° |
| active_fields | array | æ­£åœ¨çŒæº‰çš„ç”°å— |
| selected_scenario | object | å½“å‰æ‰§è¡Œçš„æ–¹æ¡ˆä¿¡æ¯ |

---

#### 5.3 åœæ­¢æ‰§è¡Œ

**æ¥å£è¯´æ˜**: åœæ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡

**è¯·æ±‚**
```
POST /api/execution/stop
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "execution_id": "exec_20250109_123456",
  "reason": "æ‰‹åŠ¨åœæ­¢"
}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "message": "æ‰§è¡Œå·²åœæ­¢",
  "data": {
    "execution_id": "exec_20250109_123456",
    "status": "stopped",
    "stop_time": "2025-01-09T14:00:00.000Z",
    "completed_batches": 2,
    "total_batches": 4
  }
}
```

---

#### 5.4 è·å–æ‰§è¡Œå†å²

**æ¥å£è¯´æ˜**: è·å–æœ€è¿‘çš„æ‰§è¡Œå†å²è®°å½•

**è¯·æ±‚**
```
GET /api/execution/history?limit=10
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| limit | integer | å¦ | è¿”å›è®°å½•æ•°ï¼Œé»˜è®¤10 |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "total": 25,
  "data": [
    {
      "execution_id": "exec_20250109_123456",
      "start_time": "2025-01-09T12:34:56.789Z",
      "end_time": "2025-01-09T14:00:00.000Z",
      "status": "completed",
      "total_batches": 4,
      "completed_batches": 4,
      "total_regenerations": 2
    }
  ]
}
```

---

### 6. æ‰¹æ¬¡ç®¡ç†

#### 6.1 è·å–æ‰¹æ¬¡åˆ—è¡¨

**æ¥å£è¯´æ˜**: è·å–å½“å‰è®¡åˆ’çš„æ‰€æœ‰æ‰¹æ¬¡ä¿¡æ¯

**è¯·æ±‚**
```
GET /api/batches?farm_id=13944136728576&status=active
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| farm_id | string | å¦ | å†œåœºID |
| status | string | å¦ | æ‰¹æ¬¡çŠ¶æ€è¿‡æ»¤ |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "total_batches": 4,
  "batches": [
    {
      "index": 1,
      "area_mu": 73.107,
      "field_count": 14,
      "fields": ["S3-G2-F1", "S3-G3-F2", "S3-G5-F3"],
      "segment_ids": ["S3", "S4"]
    },
    {
      "index": 2,
      "area_mu": 79.083,
      "field_count": 11,
      "fields": ["S4-G21-F15", "S4-G22-F16"],
      "segment_ids": ["S4", "S5", "S6"]
    }
  ],
  "farm_id": "13944136728576",
  "scenario_name": "P2å•ç‹¬ä½¿ç”¨",
  "scenario_count": 1,
  "query_time": "2025-01-09T12:34:56.789Z"
}
```

---

#### 6.2 è·å–æ‰¹æ¬¡è¯¦æƒ…

**æ¥å£è¯´æ˜**: è·å–æŒ‡å®šæ‰¹æ¬¡çš„è¯¦ç»†ä¿¡æ¯

**è¯·æ±‚**
```
GET /api/batches/{batch_index}/details
```

**è·¯å¾„å‚æ•°**
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| batch_index | integer | æ‰¹æ¬¡ç´¢å¼•ï¼ˆä»1å¼€å§‹ï¼‰ |

**å“åº”ç¤ºä¾‹**
```json
{
  "batch_index": 1,
  "area_mu": 73.107,
  "field_count": 14,
  "fields": [
    {
      "id": "S3-G2-F1",
      "area_mu": 5.225,
      "segment_id": "S3",
      "distance_rank": 1,
      "wl_mm": 0.0,
      "inlet_G_id": "S3-G2"
    }
  ],
  "segment_ids": ["S3", "S4"],
  "execution_details": {
    "status": "completed",
    "start_time": "2025-01-09T12:00:00.000Z",
    "end_time": "2025-01-09T13:30:00.000Z"
  },
  "scenario_name": "P2å•ç‹¬ä½¿ç”¨",
  "query_time": "2025-01-09T12:34:56.789Z"
}
```

---

#### 6.3 è·å–å½“å‰è®¡åˆ’

**æ¥å£è¯´æ˜**: è·å–å½“å‰æ‰§è¡Œçš„å®Œæ•´è®¡åˆ’æ•°æ®

**è¯·æ±‚**
```
GET /api/batches/current-plan
```

**å“åº”ç¤ºä¾‹**
```json
{
  "plan": {
    "calc": {},
    "batches": [],
    "steps": []
  },
  "farm_id": "13944136728576",
  "query_time": "2025-01-09T12:34:56.789Z"
}
```

---

### 7. æ°´ä½ç®¡ç†

#### 7.1 æ›´æ–°æ°´ä½æ•°æ®

**æ¥å£è¯´æ˜**: æ›´æ–°æŒ‡å®šç”°å—çš„æ°´ä½æ•°æ®

**è¯·æ±‚**
```
POST /api/water-levels/update
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "farm_id": "13944136728576",
  "field_id": "S3-G2-F1",
  "water_level_mm": 25.5,
  "timestamp": "2025-01-09T12:00:00Z",
  "source": "sensor",
  "quality": "good"
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| farm_id | string | âœ… æ˜¯ | - | å†œåœºå”¯ä¸€æ ‡è¯†ç¬¦ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æ ‡è¯†æ•°æ®æ‰€å±çš„å†œåœºï¼Œç”¨äºæ•°æ®éš”ç¦»å’Œå…³è”ã€‚<br>**ç¤ºä¾‹**: `"13944136728576"` |
| field_id | string | âœ… æ˜¯ | - | ç”°å—å”¯ä¸€æ ‡è¯†ç¬¦ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æŒ‡å®šè¦æ›´æ–°æ°´ä½çš„ç”°å—ï¼Œæ ¼å¼ä¸º"ç‰‡åŒº-é—¸é—¨-ç”°å—"ã€‚<br>**æ ¼å¼**: `S{ç‰‡åŒºç¼–å·}-G{é—¸é—¨ç¼–å·}-F{ç”°å—ç¼–å·}`<br>**ç¤ºä¾‹**: `"S3-G2-F1"` (ç¬¬3ç‰‡åŒºç¬¬2é—¸é—¨ç¬¬1å—ç”°) |
| water_level_mm | number | âœ… æ˜¯ | - | ç”°å—å½“å‰æ°´ä½æ·±åº¦ï¼ˆæ¯«ç±³ï¼‰ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç”°å—å†…çš„å®é™…æ°´æ·±ï¼Œç³»ç»Ÿæ ¹æ®æ­¤å€¼åˆ¤æ–­æ˜¯å¦éœ€è¦çŒæº‰ã€‚<br>**æ•°å€¼èŒƒå›´**: é€šå¸¸ 0-150mm<br>**ç‰¹æ®Šå€¼**: `0`è¡¨ç¤ºå¹²ç”°<br>**ç¤ºä¾‹**: `25.5` (æ°´æ·±25.5æ¯«ç±³) |
| timestamp | string | âŒ å¦ | å½“å‰æ—¶é—´ | é‡‡é›†æ•°æ®çš„æ—¶é—´æˆ³ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æ ‡è®°æ•°æ®çš„é‡‡é›†æ—¶é—´ï¼Œç•™ç©ºåˆ™ä½¿ç”¨æœåŠ¡å™¨æ¥æ”¶æ—¶é—´ã€‚å¯¹äºæ‰¹é‡å†å²æ•°æ®å¯¼å…¥ï¼Œå»ºè®®å¡«å†™å®é™…é‡‡é›†æ—¶é—´ã€‚<br>**æ ¼å¼**: ISO 8601æ ¼å¼ `YYYY-MM-DDTHH:mm:ss.sssZ`<br>**ç¤ºä¾‹**: `"2025-01-09T12:00:00Z"` |
| source | string | âŒ å¦ | `"manual"` | æ•°æ®æ¥æºç±»å‹ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æ ‡è¯†æ•°æ®çš„è·å–æ–¹å¼ï¼Œå½±å“æ•°æ®å¯ä¿¡åº¦æƒé‡ã€‚<br>**å¯é€‰å€¼**:<br>â€¢ `sensor`: ä¼ æ„Ÿå™¨è‡ªåŠ¨é‡‡é›†ï¼Œ**æœ€å¯é **<br>â€¢ `manual`: äººå·¥æ‰‹åŠ¨è¾“å…¥ï¼Œéœ€äºŒæ¬¡ç¡®è®¤<br>â€¢ `estimated`: ç³»ç»Ÿä¼°ç®—ï¼Œä»…å‚è€ƒ<br>**ç¤ºä¾‹**: `"sensor"` |
| quality | string | âŒ å¦ | `"good"` | æ•°æ®è´¨é‡ç­‰çº§ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: è¯„ä¼°æ•°æ®çš„å¯é æ€§ï¼Œå½±å“æ˜¯å¦è§¦å‘è®¡åˆ’é‡æ–°ç”Ÿæˆã€‚<br>**å¯é€‰å€¼**:<br>â€¢ `good`: æ•°æ®å¯é ï¼Œå¯ç›´æ¥ä½¿ç”¨<br>â€¢ `fair`: æ•°æ®å¯ç”¨ï¼Œä½†å¯èƒ½æœ‰åå·®<br>â€¢ `poor`: æ•°æ®è´¨é‡å·®ï¼Œå»ºè®®é‡æ–°é‡‡é›†<br>**è‡ªåŠ¨åˆ¤æ–­**: ä¼ æ„Ÿå™¨æ•°æ®é€šå¸¸ä¸º`good`ï¼Œäººå·¥è¾“å…¥å»ºè®®è®¾ä¸º`fair`<br>**ç¤ºä¾‹**: `"good"` |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "message": "æ°´ä½æ•°æ®æ›´æ–°æˆåŠŸ",
  "data": {
    "field_id": "S3-G2-F1",
    "water_level_mm": 25.5,
    "updated_at": "2025-01-09T12:00:00Z"
  }
}
```

---

#### 7.2 è·å–æ°´ä½æ±‡æ€»

**æ¥å£è¯´æ˜**: è·å–å†œåœºæˆ–æŒ‡å®šç”°å—çš„æ°´ä½æ±‡æ€»ä¿¡æ¯

**è¯·æ±‚**
```
GET /api/water-levels/summary?farm_id=13944136728576&field_ids=S3-G2-F1,S3-G3-F2
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| farm_id | string | æ˜¯ | å†œåœºID |
| field_ids | string | å¦ | ç”°å—IDåˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼‰ |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "total_fields": 36,
    "fields_with_data": 30,
    "last_update": "2025-01-09T12:00:00Z",
    "average_level": 15.5,
    "quality_summary": {
      "good": 25,
      "fair": 4,
      "poor": 1
    },
    "field_summaries": {
      "S3-G2-F1": {
        "current_level": 25.5,
        "last_update": "2025-01-09T12:00:00Z",
        "quality": "good"
      }
    }
  }
}
```

---

#### 7.3 è·å–æ°´ä½å†å²

**æ¥å£è¯´æ˜**: è·å–æŒ‡å®šç”°å—çš„æ°´ä½å†å²æ•°æ®

**è¯·æ±‚**
```
GET /api/water-levels/history?farm_id=13944136728576&field_id=S3-G2-F1&hours=24
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| farm_id | string | æ˜¯ | å†œåœºID |
| field_id | string | æ˜¯ | ç”°å—ID |
| hours | integer | å¦ | æŸ¥è¯¢æ—¶é—´èŒƒå›´ï¼ˆå°æ—¶ï¼‰ï¼Œé»˜è®¤24 |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "field_id": "S3-G2-F1",
  "data": [
    {
      "timestamp": "2025-01-09T12:00:00Z",
      "water_level_mm": 25.5,
      "source": "sensor",
      "quality": "good"
    },
    {
      "timestamp": "2025-01-09T11:00:00Z",
      "water_level_mm": 23.2,
      "source": "sensor",
      "quality": "good"
    }
  ],
  "total_records": 24
}
```

---

#### 7.4 è·å–ç”°å—æ°´ä½è¶‹åŠ¿

**æ¥å£è¯´æ˜**: è·å–ç”°å—æ°´ä½å˜åŒ–è¶‹åŠ¿åˆ†æ

**è¯·æ±‚**
```
GET /api/water-levels/trend/{field_id}?hours=48
```

**è·¯å¾„å‚æ•°**
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| field_id | string | ç”°å—ID |

**æŸ¥è¯¢å‚æ•°**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| hours | integer | å¦ | åˆ†ææ—¶é—´èŒƒå›´ï¼ˆå°æ—¶ï¼‰ï¼Œé»˜è®¤48 |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "field_id": "S3-G2-F1",
  "trend": {
    "direction": "increasing",
    "rate_mm_per_hour": 0.5,
    "prediction_24h": 37.5
  },
  "statistics": {
    "min": 10.0,
    "max": 30.0,
    "average": 22.5,
    "std_dev": 5.2
  },
  "data_points": 48
}
```

---

### 8. è®¡åˆ’é‡æ–°ç”Ÿæˆ

#### 8.1 æ‰¹æ¬¡é‡æ–°ç”Ÿæˆ

**æ¥å£è¯´æ˜**: ä¿®æ”¹æ‰¹æ¬¡å¹¶é‡æ–°ç”Ÿæˆè®¡åˆ’ï¼Œæ”¯æŒç”°å—ä¿®æ”¹ã€æ°´æ³µåˆ†é…ã€æ—¶é—´è°ƒæ•´

**è¯·æ±‚**
```
POST /api/regeneration/batch
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "original_plan_id": "/app/output/irrigation_plan_20250109_123456.json",
  "field_modifications": [
    {
      "field_id": "S3-G5-F1",
      "action": "add",
      "custom_water_level": 95.0
    },
    {
      "field_id": "S3-G5-F2",
      "action": "remove"
    }
  ],
  "pump_assignments": [
    {
      "batch_index": 1,
      "pump_ids": ["P1", "P2"]
    }
  ],
  "time_modifications": [
    {
      "batch_index": 1,
      "start_time_h": 2.0,
      "duration_h": 10.0
    }
  ],
  "regeneration_params": {
    "force_regeneration": true,
    "optimize_schedule": true
  }
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| original_plan_id | string | âœ… æ˜¯ | - | åŸå§‹çŒæº‰è®¡åˆ’IDã€‚<br>**ä¸šåŠ¡å«ä¹‰**: è¦ä¿®æ”¹çš„è®¡åˆ’æ–‡ä»¶è·¯å¾„ï¼Œä½¿ç”¨"ç”ŸæˆçŒæº‰è®¡åˆ’"æ¥å£è¿”å›çš„`plan_id`ã€‚<br>**ç¤ºä¾‹**: `"/app/output/irrigation_plan_20250109_123456.json"` |
| field_modifications | array | âŒ å¦ | `[]` | ç”°å—ä¿®æ”¹åˆ—è¡¨ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æŒ‡å®šè¦æ·»åŠ æˆ–åˆ é™¤çš„ç”°å—ã€‚å¸¸ç”¨äº:<br>â€¢ ä¸´æ—¶å¢åŠ çŒæº‰ç”°å—<br>â€¢ æ’é™¤æ•…éšœç”°å—<br>â€¢ è°ƒæ•´çŒæº‰ä¼˜å…ˆçº§<br>**æ ¼å¼**: è§ä¸‹æ–¹è¯¦ç»†è¯´æ˜ |
| pump_assignments | array | âŒ å¦ | `[]` | æ°´æ³µåˆ†é…åˆ—è¡¨ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ä¸ºç‰¹å®šæ‰¹æ¬¡æŒ‡å®šä½¿ç”¨çš„æ°´æ³µç»„åˆã€‚å¸¸ç”¨äº:<br>â€¢ æŸå°æ°´æ³µæ•…éšœï¼Œåˆ‡æ¢å¤‡ç”¨<br>â€¢ å¤šæ³µååŒä½œä¸š<br>â€¢ è´Ÿè½½å‡è¡¡<br>**æ ¼å¼**: `[{"batch_index": 1, "pump_ids": ["P1", "P2"]}]` |
| time_modifications | array | âŒ å¦ | `[]` | æ—¶é—´ä¿®æ”¹åˆ—è¡¨ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: è°ƒæ•´æ‰¹æ¬¡çš„å¼€å§‹æ—¶é—´æˆ–æŒç»­æ—¶é•¿ã€‚å¸¸ç”¨äº:<br>â€¢ é¿å¼€ç”¨ç”µé«˜å³°<br>â€¢ é€‚åº”å¤©æ°”å˜åŒ–<br>â€¢ ä¼˜åŒ–äººåŠ›è°ƒåº¦<br>**æ ¼å¼**: `[{"batch_index": 1, "start_time_h": 2.0, "duration_h": 10.0}]`<br>**âš ï¸ æ³¨æ„**: ä¿®æ”¹æ—¶é—´ä¼šè‡ªåŠ¨çº§è”è°ƒæ•´åç»­æ‰¹æ¬¡ |
| regeneration_params | object | âŒ å¦ | `{}` | é‡æ–°ç”Ÿæˆå‚æ•°ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æ§åˆ¶é‡æ–°ç”Ÿæˆçš„è¡Œä¸ºã€‚<br>**å­å­—æ®µ**:<br>â€¢ `force_regeneration`: å¼ºåˆ¶é‡æ–°ç”Ÿæˆï¼ˆå³ä½¿å˜åŒ–å¾ˆå°ï¼‰<br>â€¢ `optimize_schedule`: æ˜¯å¦ä¼˜åŒ–è°ƒåº¦é¡ºåº |

**field_modifications è¯¦ç»†è¯´æ˜**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| field_id | string | âœ… | ç”°å—å”¯ä¸€æ ‡è¯†ç¬¦ã€‚<br>**æ ¼å¼**: `S{ç‰‡åŒº}-G{é—¸é—¨}-F{ç”°å—}`<br>**ç¤ºä¾‹**: `"S3-G5-F1"` |
| action | string | âœ… | æ“ä½œç±»å‹ã€‚<br>**å¯é€‰å€¼**:<br>â€¢ `add`: æ·»åŠ ç”°å—åˆ°çŒæº‰è®¡åˆ’<br>â€¢ `remove`: ä»è®¡åˆ’ä¸­ç§»é™¤ç”°å—<br>**ç¤ºä¾‹**: `"add"` |
| custom_water_level | number | âŒ | è‡ªå®šä¹‰æ°´ä½ï¼ˆä»…`add`æ—¶éœ€è¦ï¼‰ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ä¸ºæ–°å¢ç”°å—æŒ‡å®šå½“å‰æ°´ä½ï¼Œç”¨äºè®¡ç®—çŒæº‰é‡ã€‚<br>**å•ä½**: æ¯«ç±³ (mm)<br>**ç¤ºä¾‹**: `95.0` |

**pump_assignments è¯¦ç»†è¯´æ˜**

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| batch_index | integer | æ‰¹æ¬¡ç´¢å¼•å·ï¼ˆ**ä»1å¼€å§‹**ï¼‰<br>**ç¤ºä¾‹**: `1` |
| pump_ids | array | è¯¥æ‰¹æ¬¡ä½¿ç”¨çš„æ°´æ³µåˆ—è¡¨<br>**ç¤ºä¾‹**: `["P1", "P2"]` (åŒæ—¶ä½¿ç”¨P1å’ŒP2) |

**time_modifications è¯¦ç»†è¯´æ˜**

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| batch_index | integer | æ‰¹æ¬¡ç´¢å¼•å·ï¼ˆ**ä»1å¼€å§‹**ï¼‰<br>**ç¤ºä¾‹**: `1` |
| start_time_h | number | æ–°çš„å¼€å§‹æ—¶é—´ï¼ˆå°æ—¶ï¼‰<br>**æ ¼å¼**: ç›¸å¯¹æ—¶é—´ï¼Œ`0`ä¸ºè®¡åˆ’èµ·å§‹ç‚¹<br>**ç¤ºä¾‹**: `2.0` (è®¡åˆ’å¼€å§‹å2å°æ—¶) |
| duration_h | number | æ–°çš„æŒç»­æ—¶é•¿ï¼ˆå°æ—¶ï¼‰<br>**âš ï¸ æ³¨æ„**: ç³»ç»Ÿä¼šè‡ªåŠ¨éªŒè¯æ°´æ³µæµé‡æ˜¯å¦è¶³å¤Ÿ<br>**ç¤ºä¾‹**: `10.0` (æ‰§è¡Œ10å°æ—¶) |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "message": "æ‰¹æ¬¡è®¡åˆ’é‡æ–°ç”ŸæˆæˆåŠŸï¼Œå…±è¿›è¡Œäº† 3 é¡¹ä¿®æ”¹",
  "original_plan": {
    "batches": [],
    "steps": []
  },
  "modified_plan": {
    "batches": [],
    "steps": []
  },
  "modifications_summary": {
    "field_modifications": [
      {
        "field_id": "S3-G5-F1",
        "action": "add",
        "result": "success"
      },
      {
        "field_id": "S3-G5-F2",
        "action": "remove",
        "result": "success"
      }
    ],
    "pump_assignments": [
      {
        "batch_index": 1,
        "pump_ids": ["P1", "P2"],
        "result": "success"
      }
    ],
    "time_modifications": [
      {
        "batch_index": 1,
        "start_time_h": 2.0,
        "duration_h": 10.0,
        "result": "success"
      }
    ],
    "total_changes": 3
  }
}
```

---

#### 8.2 æ‰‹åŠ¨é‡æ–°ç”Ÿæˆï¼ˆæ°´ä½ï¼‰

**æ¥å£è¯´æ˜**: åŸºäºæ–°çš„æ°´ä½æ•°æ®é‡æ–°ç”ŸæˆæŒ‡å®šæ‰¹æ¬¡ï¼Œæ”¯æŒä¸ºç‰¹å®šç”°å—è®¾ç½®è‡ªå®šä¹‰çš„æ°´ä½æ ‡å‡†

**è¯·æ±‚**
```
POST /api/regeneration/manual
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "batch_index": 1,
  "custom_water_levels": {
    "S3-G5-F3": 25.0,
    "S3-G6-F4": 28.5
  },
  "custom_water_level_standards": {
    "S3-G5-F3": {
      "wl_low": 20.0,
      "wl_opt": 70.0,
      "wl_high": 130.0
    }
  },
  "force_regeneration": true
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| batch_index | integer | âœ… æ˜¯ | - | æ‰¹æ¬¡ç´¢å¼•å·ï¼ˆ**ä»1å¼€å§‹**ï¼‰ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æŒ‡å®šè¦é‡æ–°ç”Ÿæˆçš„æ‰¹æ¬¡ã€‚<br>**ç¤ºä¾‹**: `1` |
| custom_water_levels | object | âŒ å¦ | `{}` | è‡ªå®šä¹‰ç”°å—å®é™…æ°´ä½ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ä¸ºæŒ‡å®šç”°å—è®¾ç½®å½“å‰å®é™…æ°´ä½å€¼ï¼Œæ ¼å¼ä¸º `{"ç”°å—ID": æ°´ä½å€¼(mm)}`ã€‚<br>**ä½¿ç”¨åœºæ™¯**: ä¼ æ„Ÿå™¨æ•°æ®æ›´æ–°åï¼Œæ‰‹åŠ¨è§¦å‘é‡æ–°è®¡ç®—ã€‚<br>**ç¤ºä¾‹**: `{"S3-G5-F3": 25.0}` |
| custom_water_level_standards | object | âŒ å¦ | `null` | **ğŸ†• æ–°åŠŸèƒ½** è‡ªå®šä¹‰ç”°å—çº§æ°´ä½æ ‡å‡†ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ä¸ºç‰¹å®šç”°å—è®¾ç½®ç‹¬ç«‹çš„æ°´ä½æ ‡å‡†ï¼ˆä½æ°´ä½é˜ˆå€¼ã€æœ€ä¼˜æ°´ä½ã€é«˜æ°´ä½é˜ˆå€¼ï¼‰ï¼Œè¦†ç›–å…¨å±€é»˜è®¤å€¼ã€‚ç®—æ³•å°†ä½¿ç”¨è¿™äº›è‡ªå®šä¹‰æ ‡å‡†é‡æ–°è®¡ç®—è¯¥ç”°å—çš„çŒæº‰éœ€æ±‚ã€‚<br>**æ ¼å¼**: `{"ç”°å—ID": {"wl_low": å€¼, "wl_opt": å€¼, "wl_high": å€¼}}`<br>**ä½¿ç”¨åœºæ™¯**: <br>â€¢ ä¸åŒä½œç‰©ç”Ÿé•¿é˜¶æ®µéœ€è¦ä¸åŒæ°´ä½<br>â€¢ ç‰¹æ®Šç”°å—åœŸå£¤æ¡ä»¶å·®å¼‚<br>â€¢ ç²¾å‡†çŒæº‰è¯•éªŒå¯¹æ¯”<br>**å­—æ®µè¯´æ˜**:<br>â€¢ `wl_low`: ä½æ°´ä½é˜ˆå€¼(mm)ï¼Œå¯é€‰<br>â€¢ `wl_opt`: æœ€ä¼˜æ°´ä½(mm)ï¼Œå¯é€‰<br>â€¢ `wl_high`: é«˜æ°´ä½é˜ˆå€¼(mm)ï¼Œå¯é€‰<br>**âš ï¸ æ³¨æ„**: <br>â€¢ æœªæŒ‡å®šçš„å­—æ®µä½¿ç”¨å…¨å±€é»˜è®¤å€¼<br>â€¢ ä»…åœ¨æœ¬æ¬¡è®¡ç®—ç”Ÿæ•ˆï¼Œä¸ä¼šä¿®æ”¹ config.json<br>â€¢ æœªæŒ‡å®šæ ‡å‡†çš„ç”°å—ä½¿ç”¨å…¨å±€é»˜è®¤å€¼<br>**ç¤ºä¾‹**: `{"S3-G5-F3": {"wl_low": 20.0, "wl_opt": 70.0, "wl_high": 130.0}}` |
| force_regeneration | boolean | âŒ å¦ | `false` | æ˜¯å¦å¼ºåˆ¶é‡æ–°ç”Ÿæˆã€‚<br>**ä¸šåŠ¡å«ä¹‰**: `true`æ—¶å³ä½¿å˜åŒ–å¾ˆå°ä¹Ÿé‡æ–°ç”Ÿæˆï¼Œ`false`æ—¶ç³»ç»Ÿåˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°ç”Ÿæˆã€‚<br>**ç¤ºä¾‹**: `true` |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "message": "æ‰¹æ¬¡ 1 é‡æ–°ç”ŸæˆæˆåŠŸ (åŸºäºscenario 'P1å•æ³µæ–¹æ¡ˆ')",
  "batch_index": 1,
  "scenario_name": "P1å•æ³µæ–¹æ¡ˆ",
  "scenario_count": 3,
  "changes_count": 5,
  "execution_time_adjustment_seconds": 180.0,
  "water_usage_adjustment_m3": 12.5,
  "change_summary": "å…±æœ‰5é¡¹å˜æ›´ï¼šæŒç»­æ—¶é—´è°ƒæ•´3é¡¹ï¼Œæµé‡è°ƒæ•´2é¡¹",
  "output_file": "/app/output/irrigation_plan_manual_regen_1762349810.json",
  "wl_low": 30.0,
  "wl_opt": 80.0,
  "wl_high": 140.0,
  "d_target_mm": 90.0,
  "field_water_level_standards": {
    "S3-G5-F3": {
      "wl_low": 20.0,
      "wl_opt": 70.0,
      "wl_high": 130.0
    }
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| success | boolean | æ“ä½œæ˜¯å¦æˆåŠŸ |
| message | string | è¯¦ç»†æ¶ˆæ¯ |
| batch_index | integer | æ‰¹æ¬¡ç´¢å¼• |
| scenario_name | string | å½“å‰ä½¿ç”¨çš„scenarioåç§° |
| scenario_count | integer | è®¡åˆ’ä¸­åŒ…å«çš„scenarioæ€»æ•° |
| changes_count | integer | å®é™…å˜æ›´é¡¹ç›®æ•°é‡ |
| execution_time_adjustment_seconds | float | æ‰§è¡Œæ—¶é—´è°ƒæ•´ï¼ˆç§’ï¼‰ |
| water_usage_adjustment_m3 | float | ç”¨æ°´é‡è°ƒæ•´ï¼ˆç«‹æ–¹ç±³ï¼‰ |
| change_summary | string | å˜æ›´æ‘˜è¦æè¿° |
| output_file | string | ä¿å­˜çš„JSONæ–‡ä»¶è·¯å¾„ |
| **wl_low** | **float** | **å…¨å±€ä½æ°´ä½é˜ˆå€¼ï¼ˆmmï¼‰**ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç³»ç»Ÿé»˜è®¤çš„ä½æ°´ä½é˜ˆå€¼ï¼Œå½“ç”°å—æ°´ä½ä½äºæ­¤å€¼æ—¶è§¦å‘çŒæº‰ã€‚<br>**æ•°æ®æ¥æº**: æ¥è‡ª config.json çš„å…¨å±€é…ç½®ã€‚<br>**ç¤ºä¾‹**: `30.0` |
| **wl_opt** | **float** | **å…¨å±€æœ€ä¼˜æ°´ä½ï¼ˆmmï¼‰**ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç³»ç»Ÿé»˜è®¤çš„æœ€ä¼˜æ°´ä½ç›®æ ‡ï¼ŒçŒæº‰çš„ç›®æ ‡æ˜¯å°†ç”°å—æ°´ä½æå‡åˆ°æ­¤å€¼ã€‚<br>**æ•°æ®æ¥æº**: æ¥è‡ª config.json çš„å…¨å±€é…ç½®ã€‚<br>**çŒæº‰é€»è¾‘**: ç¼ºæ°´æ·±åº¦ = wl_opt - wl_mm<br>**ç¤ºä¾‹**: `80.0` |
| **wl_high** | **float** | **å…¨å±€é«˜æ°´ä½é˜ˆå€¼ï¼ˆmmï¼‰**ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç³»ç»Ÿé»˜è®¤çš„é«˜æ°´ä½é˜ˆå€¼ï¼Œå½“ç”°å—æ°´ä½è¶…è¿‡æ­¤å€¼æ—¶ä¸éœ€è¦çŒæº‰ã€‚<br>**æ•°æ®æ¥æº**: æ¥è‡ª config.json çš„å…¨å±€é…ç½®ã€‚<br>**ç¤ºä¾‹**: `140.0` |
| **d_target_mm** | **float** | **ç›®æ ‡çŒæº‰æ°´æ·±ï¼ˆmmï¼‰**ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: å‚è€ƒå€¼ï¼Œå®é™…çŒæº‰æ·±åº¦ç”±åŠ¨æ€è®¡ç®—å†³å®šï¼ˆwl_opt - wl_mmï¼‰ã€‚<br>**ç¤ºä¾‹**: `90.0` |
| **field_water_level_standards** | **object\|null** | **ğŸ†• ç”°å—çº§æ°´ä½æ ‡å‡†ï¼ˆå¦‚æœæœ‰è‡ªå®šä¹‰ï¼‰**ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: è¿”å›æœ¬æ¬¡è®¡ç®—ä¸­ä½¿ç”¨çš„ç”°å—çº§è‡ªå®šä¹‰æ°´ä½æ ‡å‡†ã€‚å¦‚æœè¯·æ±‚ä¸­ä¼ å…¥äº† `custom_water_level_standards`ï¼Œæ­¤å­—æ®µä¼šè¿”å›å®é™…åº”ç”¨çš„æ ‡å‡†ã€‚<br>**æ ¼å¼**: `{"ç”°å—ID": {"wl_low": å€¼, "wl_opt": å€¼, "wl_high": å€¼}}`<br>**å€¼è¯´æ˜**: <br>â€¢ `null`: æ²¡æœ‰ä½¿ç”¨ç”°å—çº§è‡ªå®šä¹‰æ ‡å‡†<br>â€¢ `{...}`: åŒ…å«ä½¿ç”¨äº†è‡ªå®šä¹‰æ ‡å‡†çš„ç”°å—<br>**ä½¿ç”¨åœºæ™¯**: å‰ç«¯å¯å±•ç¤ºå“ªäº›ç”°å—ä½¿ç”¨äº†ç‰¹æ®Šçš„æ°´ä½æ ‡å‡†ï¼Œä¾¿äºè¿½è¸ªå’ŒéªŒè¯ã€‚<br>**ç¤ºä¾‹**: `{"S3-G5-F3": {"wl_low": 20.0, "wl_opt": 70.0, "wl_high": 130.0}}` |

---

### 9. æ‰¹æ¬¡é—´ç”°å—è°ƒæ•´

#### 9.1 æ‰¹æ¬¡é—´ç”°å—è°ƒæ•´

**æ¥å£è¯´æ˜**: åœ¨ä¸æ”¹å˜æ‰¹æ¬¡æ•°é‡çš„æƒ…å†µä¸‹ï¼Œè°ƒæ•´ç”°å—åœ¨æ‰¹æ¬¡é—´çš„åˆ†é…ã€‚ä¿æŒç°æœ‰æ‰¹æ¬¡ç»“æ„ï¼Œé‡æ–°è®¡ç®—çŒæº‰é¡ºåºå’Œæ—¶é—´ã€‚

**ä¸æ‰¹æ¬¡é‡æ–°ç”Ÿæˆçš„åŒºåˆ«**:
- `/api/regeneration/batch`: å¢å‡ç”°å—ï¼Œ**å¯èƒ½æ”¹å˜æ‰¹æ¬¡æ•°é‡å’Œç»“æ„**ï¼Œé€‚ç”¨äºç”°å—å¢å‡åœºæ™¯
- `/api/batch/adjust`: æ‰¹æ¬¡é—´ç§»åŠ¨ç”°å—ï¼Œ**æ‰¹æ¬¡æ•°é‡ä¸å˜**ï¼Œåªè°ƒæ•´åˆ†é…ï¼Œé€‚ç”¨äºä¼˜åŒ–ç°æœ‰æ‰¹æ¬¡åœºæ™¯

**è¯·æ±‚**
```
POST /api/batch/adjust
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°**
```json
{
  "plan_id": "/app/output/irrigation_plan_20250109_123456.json",
  "field_adjustments": [
    {
      "field_id": "S3-G5-F3",
      "from_batch": 1,
      "to_batch": 2
    },
    {
      "field_id": "S5-G27-F19",
      "from_batch": 2,
      "to_batch": 1
    }
  ],
  "options": {
    "recalculate_sequence": true,
    "recalculate_timing": true,
    "maintain_pump_assignments": true,
    "regenerate_commands": true
  }
}
```

**å‚æ•°è¯´æ˜**
| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| plan_id | string | âœ… æ˜¯ | - | çŒæº‰è®¡åˆ’IDæˆ–æ–‡ä»¶è·¯å¾„ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: è¦è°ƒæ•´çš„è®¡åˆ’æ–‡ä»¶è·¯å¾„ï¼Œä½¿ç”¨"ç”ŸæˆçŒæº‰è®¡åˆ’"æ¥å£è¿”å›çš„`plan_id`ã€‚<br>**ç¤ºä¾‹**: `"/app/output/irrigation_plan_20250109_123456.json"` æˆ– `"output/irrigation_plan_20250109_123456.json"` (ç›¸å¯¹è·¯å¾„) |
| field_adjustments | array | âœ… æ˜¯ | - | ç”°å—è°ƒæ•´åˆ—è¡¨ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æŒ‡å®šè¦åœ¨æ‰¹æ¬¡é—´ç§»åŠ¨çš„ç”°å—ã€‚æ”¯æŒå¤šä¸ªç”°å—åŒæ—¶ç§»åŠ¨ï¼Œå¯ä»¥å®ç°æ‰¹æ¬¡é—´ç”°å—äº¤æ¢ã€‚<br>**å¸¸ç”¨åœºæ™¯**:<br>â€¢ ä¼˜åŒ–æ‰¹æ¬¡è´Ÿè½½å‡è¡¡<br>â€¢ è°ƒæ•´çŒæº‰ä¼˜å…ˆçº§<br>â€¢ æ ¹æ®å®é™…æƒ…å†µé‡æ–°åˆ†é…ç”°å—<br>**æ ¼å¼**: è§ä¸‹æ–¹è¯¦ç»†è¯´æ˜ |
| options | object | âŒ å¦ | å…¨éƒ¨ä¸º`true` | è°ƒæ•´é€‰é¡¹é…ç½®ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: æ§åˆ¶è°ƒæ•´åçš„é‡æ–°è®¡ç®—è¡Œä¸ºã€‚<br>**å­å­—æ®µ**:<br>â€¢ `recalculate_sequence`: æ˜¯å¦é‡æ–°è®¡ç®—çŒæº‰é¡ºåº<br>â€¢ `recalculate_timing`: æ˜¯å¦é‡æ–°è®¡ç®—æ—¶é—´<br>â€¢ `maintain_pump_assignments`: æ˜¯å¦ä¿æŒæ°´æ³µåˆ†é…<br>â€¢ `regenerate_commands`: æ˜¯å¦é‡æ–°ç”Ÿæˆå‘½ä»¤ |

**field_adjustments è¯¦ç»†è¯´æ˜**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| field_id | string | âœ… | ç”°å—å”¯ä¸€æ ‡è¯†ç¬¦ã€‚<br>**æ ¼å¼**: `S{ç‰‡åŒº}-G{é—¸é—¨}-F{ç”°å—}`<br>**ç¤ºä¾‹**: `"S3-G5-F3"` |
| from_batch | integer | âœ… | æºæ‰¹æ¬¡ç´¢å¼•ï¼ˆ**ä»1å¼€å§‹**ï¼‰ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: ç”°å—å½“å‰æ‰€åœ¨çš„æ‰¹æ¬¡ã€‚<br>**ç¤ºä¾‹**: `1` |
| to_batch | integer | âœ… | ç›®æ ‡æ‰¹æ¬¡ç´¢å¼•ï¼ˆ**ä»1å¼€å§‹**ï¼‰ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: è¦å°†ç”°å—ç§»åŠ¨åˆ°çš„ç›®æ ‡æ‰¹æ¬¡ã€‚<br>**âš ï¸ æ³¨æ„**: å¿…é¡»æ˜¯å·²å­˜åœ¨çš„æ‰¹æ¬¡ç´¢å¼•<br>**ç¤ºä¾‹**: `2` |

**options è¯¦ç»†è¯´æ˜**

| å­—æ®µ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| recalculate_sequence | boolean | `true` | æ˜¯å¦é‡æ–°è®¡ç®—æ‰¹æ¬¡å†…ç”°å—çš„çŒæº‰é¡ºåºã€‚<br>**ä¸šåŠ¡å«ä¹‰**: `true`æ—¶ï¼Œç³»ç»Ÿä¼šæ ¹æ®è·ç¦»ç­‰çº§é‡æ–°æ’åºç”°å—ï¼Œä¼˜åŒ–çŒæº‰è·¯å¾„ã€‚<br>**å»ºè®®**: é€šå¸¸ä¿æŒ`true` |
| recalculate_timing | boolean | `true` | æ˜¯å¦é‡æ–°è®¡ç®—æ‰¹æ¬¡æ—¶é—´ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: `true`æ—¶ï¼Œç³»ç»Ÿä¼šæ ¹æ®æ–°çš„ç”°å—åˆ†é…é‡æ–°è®¡ç®—æ¯ä¸ªæ‰¹æ¬¡çš„çŒæº‰æ—¶é•¿å’Œé¢„è®¡å®Œæˆæ—¶é—´ã€‚<br>**å»ºè®®**: é€šå¸¸ä¿æŒ`true` |
| maintain_pump_assignments | boolean | `true` | æ˜¯å¦ä¿æŒåŸæœ‰æ°´æ³µåˆ†é…ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: `true`æ—¶ä¿æŒåŸè®¡åˆ’çš„æ°´æ³µé…ç½®ï¼Œ`false`æ—¶å¯èƒ½æ ¹æ®æ–°åˆ†é…é‡æ–°é€‰æ‹©æ°´æ³µã€‚<br>**å»ºè®®**: ä¿æŒ`true`ä»¥é¿å…æ°´æ³µé…ç½®å˜åŒ– |
| regenerate_commands | boolean | `true` | æ˜¯å¦é‡æ–°ç”Ÿæˆæ‰§è¡Œå‘½ä»¤ã€‚<br>**ä¸šåŠ¡å«ä¹‰**: `true`æ—¶ï¼Œç³»ç»Ÿä¼šæ›´æ–°`steps`ä¸­çš„è¯¦ç»†æ‰§è¡ŒæŒ‡ä»¤ï¼ˆåŒ…æ‹¬`sequence.fields`å’Œ`full_order`ï¼‰ï¼Œç¡®ä¿å‘½ä»¤ä¸æ‰¹æ¬¡ä¸€è‡´ã€‚<br>**âš ï¸ é‡è¦**: å¿…é¡»è®¾ä¸º`true`ï¼Œå¦åˆ™æ‰§è¡Œæ—¶ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´ |

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "message": "æ‰¹æ¬¡é—´ç”°å—è°ƒæ•´æˆåŠŸ",
  "original_plan": {
    "batches": [
      {
        "index": 1,
        "fields": [
          {"id": "S3-G5-F3", "area_mu": 5.225}
        ]
      },
      {
        "index": 2,
        "fields": [
          {"id": "S5-G27-F19", "area_mu": 6.358}
        ]
      }
    ]
  },
  "adjusted_plan": {
    "batches": [
      {
        "index": 1,
        "fields": [
          {"id": "S5-G27-F19", "area_mu": 6.358}
        ]
      },
      {
        "index": 2,
        "fields": [
          {"id": "S3-G5-F3", "area_mu": 5.225}
        ]
      }
    ]
  },
  "changes_summary": {
    "total_fields_moved": 2,
    "affected_batches": [1, 2],
    "field_movements": [
      {
        "field_id": "S3-G5-F3",
        "from_batch": 1,
        "to_batch": 2,
        "status": "success"
      },
      {
        "field_id": "S5-G27-F19",
        "from_batch": 2,
        "to_batch": 1,
        "status": "success"
      }
    ],
    "batch_time_changes": [
      {
        "batch_index": 1,
        "old_duration_h": 18.28,
        "new_duration_h": 19.15,
        "time_diff_h": 0.87
      },
      {
        "batch_index": 2,
        "old_duration_h": 19.15,
        "new_duration_h": 18.28,
        "time_diff_h": -0.87
      }
    ]
  },
  "validation": {
    "is_valid": true,
    "total_fields": 36,
    "total_batches": 4,
    "warnings": []
  },
  "output_file": "/app/output/irrigation_plan_20250109_123456_adjusted_20250109_140530.json"
}
```

**å…³é”®å­—æ®µè¯´æ˜**
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| original_plan | object | åŸå§‹è®¡åˆ’çš„å…³é”®ä¿¡æ¯ï¼ˆä»…åŒ…å«å—å½±å“æ‰¹æ¬¡ï¼‰ |
| adjusted_plan | object | è°ƒæ•´åçš„å®Œæ•´è®¡åˆ’æ•°æ® |
| changes_summary | object | å˜æ›´æ‘˜è¦ä¿¡æ¯ |
| changes_summary.total_fields_moved | integer | ç§»åŠ¨çš„ç”°å—æ€»æ•° |
| changes_summary.affected_batches | array | å—å½±å“çš„æ‰¹æ¬¡ç´¢å¼•åˆ—è¡¨ |
| changes_summary.field_movements | array | æ¯ä¸ªç”°å—çš„ç§»åŠ¨è¯¦æƒ… |
| changes_summary.batch_time_changes | array | æ‰¹æ¬¡æ—¶é—´å˜åŒ–è¯¦æƒ… |
| validation | object | éªŒè¯ç»“æœ |
| validation.is_valid | boolean | è°ƒæ•´åçš„è®¡åˆ’æ˜¯å¦æœ‰æ•ˆ |
| validation.warnings | array | è­¦å‘Šä¿¡æ¯ï¼ˆå¦‚æœ‰ï¼‰ |
| output_file | string | è°ƒæ•´åè®¡åˆ’ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ |

**ä½¿ç”¨åœºæ™¯**

| åœºæ™¯ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **è´Ÿè½½å‡è¡¡** | æŸä¸ªæ‰¹æ¬¡ç”°å—è¿‡å¤šï¼ŒçŒæº‰æ—¶é—´è¿‡é•¿ | å°†éƒ¨åˆ†ç”°å—ç§»è‡³å…¶ä»–æ‰¹æ¬¡ï¼Œå¹³è¡¡å„æ‰¹æ¬¡æ—¶é•¿ |
| **ä¼˜å…ˆçº§è°ƒæ•´** | éœ€è¦ä¼˜å…ˆçŒæº‰æŸäº›ç”°å— | å°†æ€¥éœ€çŒæº‰çš„ç”°å—ç§»è‡³ç¬¬1æ‰¹æ¬¡ |
| **æ•…éšœåº”å¯¹** | æŸæ‰¹æ¬¡çš„æ°´æ³µæˆ–é—¸é—¨æ•…éšœ | å°†è¯¥æ‰¹æ¬¡çš„ç”°å—åˆ†æ•£åˆ°å…¶ä»–æ‰¹æ¬¡ |
| **ç”°å—äº¤æ¢** | ä¸¤ä¸ªæ‰¹æ¬¡é—´äº’æ¢ç”°å— | åŒæ—¶ç§»åŠ¨ä¸¤ä¸ªæ–¹å‘çš„ç”°å—ï¼Œå®ç°äº¤æ¢ |

**æ³¨æ„äº‹é¡¹**
1. âš ï¸ è°ƒæ•´ä¸ä¼šæ”¹å˜æ‰¹æ¬¡æ€»æ•°ï¼Œåªä¼šé‡æ–°åˆ†é…ç”°å—
2. âš ï¸ å¿…é¡»ç¡®ä¿`from_batch`ä¸­åŒ…å«æŒ‡å®šçš„`field_id`
3. âš ï¸ å»ºè®®è°ƒæ•´åæ£€æŸ¥`validation.is_valid`ç¡®ä¿è®¡åˆ’æœ‰æ•ˆ
4. âš ï¸ è°ƒæ•´ä¼šç”Ÿæˆæ–°çš„è®¡åˆ’æ–‡ä»¶ï¼ŒåŸè®¡åˆ’æ–‡ä»¶ä¸ä¼šè¢«ä¿®æ”¹
5. âœ… æ”¯æŒå¤šåœºæ™¯è®¡åˆ’ï¼ˆå¦‚P1å•ç‹¬ã€P2å•ç‹¬ã€P1+P2ç»„åˆï¼‰ï¼Œä¼šåŒæ—¶æ›´æ–°æ‰€æœ‰åœºæ™¯
6. âœ… ç³»ç»Ÿä¼šè‡ªåŠ¨æ›´æ–°`batches`ã€`steps`ã€`sequence.fields`å’Œ`full_order`ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´

---

## å…¸å‹ä¸šåŠ¡æµç¨‹

### æµç¨‹1ï¼šæ ‡å‡†çŒæº‰è®¡åˆ’ç”Ÿæˆä¸æ‰§è¡Œ 

**é€‚ç”¨åœºæ™¯**: æœ€å¸¸ç”¨çš„æ ‡å‡†æµç¨‹
```javascript
// æ­¥éª¤1: ç”ŸæˆçŒæº‰è®¡åˆ’
const planResponse = await fetch(`${BASE_URL}/api/irrigation/plan-generation`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    farm_id: "13944136728576",
    multi_pump_scenarios: true
  })
});
const planData = await planResponse.json();
const planId = planData.plan_id; // ä¿å­˜plan_id

// æ­¥éª¤2: å¯åŠ¨åŠ¨æ€æ‰§è¡Œ
const execResponse = await fetch(`${BASE_URL}/api/execution/start`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    plan_file_path: planId,  // ä½¿ç”¨æ­¥éª¤1çš„plan_id
    farm_id: "13944136728576",
    auto_start: true,
    enable_plan_regeneration: true
  })
});
const execData = await execResponse.json();
const executionId = execData.data.execution_id;

// æ­¥éª¤3: è½®è¯¢æŸ¥è¯¢æ‰§è¡ŒçŠ¶æ€
const checkStatus = async () => {
  const statusResponse = await fetch(
    `${BASE_URL}/api/execution/status?execution_id=${executionId}`
  );
  const statusData = await statusResponse.json();
  
  if (statusData.data.status === 'completed') {
    console.log('æ‰§è¡Œå®Œæˆï¼');
  } else if (statusData.data.status === 'running') {
    console.log(`æ‰§è¡Œä¸­: ${statusData.data.progress_percent}%`);
    setTimeout(checkStatus, 5000); // 5ç§’åå†æ¬¡æŸ¥è¯¢
  }
};
checkStatus();
```

**æµç¨‹å›¾**:
```
ç”Ÿæˆè®¡åˆ’ â†’ è·å–plan_id â†’ å¯åŠ¨æ‰§è¡Œ â†’ è·å–execution_id â†’ è½®è¯¢çŠ¶æ€ â†’ å®Œæˆ
```

---

### æµç¨‹2ï¼šå¤šæ–¹æ¡ˆå¯¹æ¯”å†³ç­–

**é€‚ç”¨åœºæ™¯**: éœ€è¦å¯¹æ¯”å¤šä¸ªæ–¹æ¡ˆé€‰æ‹©æœ€ä¼˜è§£

```javascript
// æ­¥éª¤1: ç”Ÿæˆè®¡åˆ’ï¼ˆåŒ…å«å¤šæ°´æ³µæ–¹æ¡ˆï¼‰
const planResponse = await fetch(`${BASE_URL}/api/irrigation/plan-generation`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    farm_id: "13944136728576",
    multi_pump_scenarios: true
  })
});
const planData = await planResponse.json();

// æ­¥éª¤2: æŸ¥çœ‹å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”
const scenarios = planData.multi_pump_scenarios.scenarios;
scenarios.forEach(scenario => {
  console.log(`æ–¹æ¡ˆ: ${scenario.scenario_name}`);
  console.log(`  ç”µè´¹: Â¥${scenario.total_electricity_cost}`);
  console.log(`  æ—¶é•¿: ${scenario.total_eta_h}å°æ—¶`);
  console.log(`  æ°´æ³µ: ${scenario.pumps_used.join(', ')}`);
});

// æ­¥éª¤3: ç”¨æˆ·é€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆåå¯åŠ¨æ‰§è¡Œ
const selectedPlanId = planData.plan_id;
// ... å¯åŠ¨æ‰§è¡Œï¼ˆå‚è€ƒæµç¨‹1æ­¥éª¤2ï¼‰
```

---

### æµç¨‹3ï¼šæ™ºèƒ½ä¼˜åŒ–æ–¹æ¡ˆç”Ÿæˆ

**é€‚ç”¨åœºæ™¯**: éœ€è¦æ ¹æ®ä¸åŒä¼˜åŒ–ç›®æ ‡ç”Ÿæˆå¤šä¸ªæ–¹æ¡ˆ

```javascript
// æ­¥éª¤1: ç”ŸæˆåŸºç¡€è®¡åˆ’
const planResponse = await fetch(`${BASE_URL}/api/irrigation/plan-generation`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    farm_id: "13944136728576"
  })
});
const planData = await planResponse.json();
const planId = planData.plan_id;

// æ­¥éª¤2: ç”Ÿæˆä¼˜åŒ–æ–¹æ¡ˆ
const optResponse = await fetch(`${BASE_URL}/api/irrigation/plan-optimization`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    original_plan_id: planId,
    optimization_goals: [
      "cost_minimization",
      "time_minimization",
      "balanced",
      "off_peak"
    ],
    constraints: {
      max_duration_hours: 24,
      electricity_price_schedule: {
        peak: { hours: [8,9,10,11,12,13,14,15,16,17,18,19,20,21], price: 1.0 },
        valley: { hours: [22,23,0,1,2,3,4,5,6,7], price: 0.4 }
      }
    }
  })
});
const optData = await optResponse.json();

// æ­¥éª¤3: å±•ç¤ºä¼˜åŒ–æ–¹æ¡ˆå¯¹æ¯”
console.log(`æ¨èæ–¹æ¡ˆ: ${optData.comparison.recommended}`);
console.log(`æœ€å¤§èŠ‚çœ: ${optData.comparison.cost_range.savings_percent}%`);

optData.scenarios.forEach(scenario => {
  console.log(`\n${scenario.name}`);
  console.log(`è¯´æ˜: ${scenario.description}`);
  console.log(`ç”µè´¹: Â¥${scenario.total_electricity_cost}`);
  console.log(`æ—¶é•¿: ${scenario.total_eta_h}å°æ—¶`);
});

// æ­¥éª¤4: ç”¨æˆ·é€‰æ‹©æ–¹æ¡ˆåæ‰§è¡Œï¼ˆä½¿ç”¨é€‰ä¸­æ–¹æ¡ˆçš„planæ•°æ®ï¼‰
```

---

### æµç¨‹4ï¼šå®æ—¶æ°´ä½æ›´æ–°ä¸è®¡åˆ’è°ƒæ•´

**é€‚ç”¨åœºæ™¯**: æ‰§è¡Œè¿‡ç¨‹ä¸­æ ¹æ®å®æ—¶æ°´ä½è°ƒæ•´è®¡åˆ’

```javascript
// æ­¥éª¤1: å¯åŠ¨æ‰§è¡Œï¼ˆå‚è€ƒæµç¨‹1ï¼‰
// ...

// æ­¥éª¤2: æ¥æ”¶ä¼ æ„Ÿå™¨æ°´ä½æ•°æ®å¹¶æ›´æ–°
const updateWaterLevel = async (fieldId, waterLevel) => {
  await fetch(`${BASE_URL}/api/water-levels/update`, {
    method: 'POST',
    headers: headers,
    body: JSON.stringify({
      farm_id: "13944136728576",
      field_id: fieldId,
      water_level_mm: waterLevel,
      source: "sensor",
      quality: "good"
    })
  });
};

// æ¨¡æ‹Ÿä¼ æ„Ÿå™¨æ•°æ®æ›´æ–°
updateWaterLevel("S3-G2-F1", 28.5);
updateWaterLevel("S3-G3-F2", 32.1);

// æ­¥éª¤3: ç³»ç»Ÿä¼šè‡ªåŠ¨æ ¹æ®æ–°æ°´ä½é‡æ–°ç”Ÿæˆè®¡åˆ’ï¼ˆå¦‚æœå¯ç”¨äº†enable_plan_regenerationï¼‰
// å‰ç«¯å¯ä»¥é€šè¿‡æŸ¥è¯¢æ‰§è¡ŒçŠ¶æ€ç›‘æ§é‡æ–°ç”Ÿæˆæ¬¡æ•°
const statusResponse = await fetch(
  `${BASE_URL}/api/execution/status?execution_id=${executionId}`
);
const statusData = await statusResponse.json();
console.log(`è®¡åˆ’å·²é‡æ–°ç”Ÿæˆ ${statusData.data.total_regenerations} æ¬¡`);
```

---

### æµç¨‹5ï¼šæ‰¹æ¬¡ç¼–è¾‘ä¸é‡æ–°ç”Ÿæˆ 

**é€‚ç”¨åœºæ™¯**: æ‰‹åŠ¨è°ƒæ•´æ‰¹æ¬¡å†…å®¹ï¼ˆæ·»åŠ /åˆ é™¤ç”°å—ã€è°ƒæ•´æ—¶é—´ç­‰ï¼‰

```javascript
// æ­¥éª¤1: ç”Ÿæˆåˆå§‹è®¡åˆ’
const planResponse = await fetch(`${BASE_URL}/api/irrigation/plan-generation`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    farm_id: "13944136728576"
  })
});
const planData = await planResponse.json();
const planId = planData.plan_id;

// æ­¥éª¤2: æŸ¥çœ‹æ‰¹æ¬¡è¯¦æƒ…
const batchResponse = await fetch(`${BASE_URL}/api/batches/1/details`);
const batchData = await batchResponse.json();
console.log('å½“å‰æ‰¹æ¬¡ç”°å—:', batchData.fields.map(f => f.id));

// æ­¥éª¤3: ä¿®æ”¹æ‰¹æ¬¡ï¼ˆæ·»åŠ ç”°å—ã€è°ƒæ•´æ—¶é—´ï¼‰
const regenResponse = await fetch(`${BASE_URL}/api/regeneration/batch`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    original_plan_id: planId,
    field_modifications: [
      { field_id: "S3-G5-F1", action: "add", custom_water_level: 95.0 },
      { field_id: "S3-G5-F2", action: "remove" }
    ],
    time_modifications: [
      { batch_index: 1, start_time_h: 2.0, duration_h: 10.0 }
    ]
  })
});
const regenData = await regenResponse.json();

// æ­¥éª¤4: ä½¿ç”¨ä¿®æ”¹åçš„è®¡åˆ’æ‰§è¡Œ
// ä½¿ç”¨ regenData.modified_plan æˆ–ä¿å­˜çš„æ–°è®¡åˆ’æ–‡ä»¶
```

---

### æµç¨‹6ï¼šæ‰¹æ¬¡é—´ç”°å—è°ƒæ•´ä¼˜åŒ–

**é€‚ç”¨åœºæ™¯**: å·²æœ‰è®¡åˆ’ï¼Œéœ€è¦ä¼˜åŒ–æ‰¹æ¬¡é—´çš„ç”°å—åˆ†é…

```javascript
// æ­¥éª¤1: ç”Ÿæˆåˆå§‹è®¡åˆ’
const planResponse = await fetch(`${BASE_URL}/api/irrigation/plan-generation`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    farm_id: "13944136728576",
    multi_pump_scenarios: true
  })
});
const planData = await planResponse.json();
const planId = planData.plan_id;

// æ­¥éª¤2: æŸ¥çœ‹å½“å‰æ‰¹æ¬¡åˆ†é…
const batchesResponse = await fetch(`${BASE_URL}/api/batches?farm_id=13944136728576`);
const batchesData = await batchesResponse.json();

// åˆ†ææ‰¹æ¬¡ï¼Œå‘ç°æ‰¹æ¬¡1æ—¶é—´è¿‡é•¿ï¼Œæ‰¹æ¬¡2æ—¶é—´è¾ƒçŸ­
console.log('æ‰¹æ¬¡1æ—¶é•¿:', batchesData.batches[0].duration_h); // ä¾‹å¦‚: 20.5h
console.log('æ‰¹æ¬¡2æ—¶é•¿:', batchesData.batches[1].duration_h); // ä¾‹å¦‚: 15.2h

// æ­¥éª¤3: è°ƒæ•´ç”°å—åˆ†é…ï¼ˆäº¤æ¢ä¸¤ä¸ªç”°å—å®ç°è´Ÿè½½å‡è¡¡ï¼‰
const adjustResponse = await fetch(`${BASE_URL}/api/batch/adjust`, {
  method: 'POST',
  headers: headers,
  body: JSON.stringify({
    plan_id: planId,
    field_adjustments: [
      {
        field_id: "S3-G5-F3",      // ä»æ‰¹æ¬¡1ç§»åˆ°æ‰¹æ¬¡2
        from_batch: 1,
        to_batch: 2
      },
      {
        field_id: "S5-G27-F19",    // ä»æ‰¹æ¬¡2ç§»åˆ°æ‰¹æ¬¡1ï¼ˆäº¤æ¢ï¼‰
        from_batch: 2,
        to_batch: 1
      }
    ],
    options: {
      recalculate_sequence: true,
      recalculate_timing: true,
      maintain_pump_assignments: true,
      regenerate_commands: true
    }
  })
});
const adjustData = await adjustResponse.json();

// æ­¥éª¤4: æŸ¥çœ‹è°ƒæ•´ç»“æœ
console.log('è°ƒæ•´æˆåŠŸ:', adjustData.success);
console.log('ç§»åŠ¨ç”°å—æ•°:', adjustData.changes_summary.total_fields_moved);

// æŸ¥çœ‹æ—¶é—´å˜åŒ–
adjustData.changes_summary.batch_time_changes.forEach(change => {
  console.log(`æ‰¹æ¬¡${change.batch_index}: ${change.old_duration_h}h -> ${change.new_duration_h}h`);
  console.log(`  å˜åŒ–: ${change.time_diff_h > 0 ? '+' : ''}${change.time_diff_h}h`);
});

// æ­¥éª¤5: éªŒè¯è°ƒæ•´åçš„è®¡åˆ’
if (adjustData.validation.is_valid) {
  console.log('âœ… è°ƒæ•´åçš„è®¡åˆ’æœ‰æ•ˆï¼Œå¯ä»¥æ‰§è¡Œ');
  
  // æ­¥éª¤6: ä½¿ç”¨è°ƒæ•´åçš„è®¡åˆ’æ‰§è¡Œ
  const execResponse = await fetch(`${BASE_URL}/api/execution/start`, {
    method: 'POST',
    headers: headers,
    body: JSON.stringify({
      plan_file_path: adjustData.output_file,  // ä½¿ç”¨è°ƒæ•´åçš„è®¡åˆ’æ–‡ä»¶
      farm_id: "13944136728576",
      auto_start: true,
      enable_plan_regeneration: true
    })
  });
} else {
  console.log('âŒ è°ƒæ•´åçš„è®¡åˆ’æ— æ•ˆ:', adjustData.validation.warnings);
}
```

**æµç¨‹å›¾**:
```
ç”Ÿæˆè®¡åˆ’ â†’ åˆ†ææ‰¹æ¬¡ â†’ è¯†åˆ«ä¼˜åŒ–ç‚¹ â†’ è°ƒæ•´ç”°å—åˆ†é… â†’ éªŒè¯è®¡åˆ’ â†’ æ‰§è¡Œ
```

---

## é”™è¯¯ç è¯´æ˜
### HTTP çŠ¶æ€ç 

| çŠ¶æ€ç  | è¯´æ˜ | å¤„ç†å»ºè®® |
|--------|------|----------|
| 200 | æˆåŠŸ | æ­£å¸¸å¤„ç†å“åº”æ•°æ® |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼å’Œå¿…å¡«é¡¹ |
| 404 | èµ„æºä¸å­˜åœ¨ | æ£€æŸ¥plan_idã€execution_idç­‰æ˜¯å¦æ­£ç¡® |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | æŸ¥çœ‹detailå­—æ®µè·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ |

### ä¸šåŠ¡é”™è¯¯ç 

é”™è¯¯å“åº”æ ¼å¼ï¼š
```json
{
  "detail": "é”™è¯¯æè¿°ä¿¡æ¯"
}
```

**å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ³•**:

| é”™è¯¯ä¿¡æ¯ | åŸå›  | è§£å†³æ–¹æ³• |
|---------|------|----------|
| "æœªæ‰¾åˆ°è®¡åˆ’: {plan_id}" | plan_idä¸å­˜åœ¨æˆ–è·¯å¾„é”™è¯¯ | ç¡®ä¿ä½¿ç”¨ç”Ÿæˆæ¥å£è¿”å›çš„å®Œæ•´plan_id |
| "çŒæº‰è®¡åˆ’æ–‡ä»¶ä¸å­˜åœ¨" | è®¡åˆ’æ–‡ä»¶å·²è¢«åˆ é™¤ | é‡æ–°ç”Ÿæˆè®¡åˆ’ |
| "å¯åŠ¨åŠ¨æ€æ‰§è¡Œå¤±è´¥: æ— æ³•åŠ è½½çŒæº‰è®¡åˆ’" | plan_file_pathæ ¼å¼é”™è¯¯ | ä½¿ç”¨æ­£ç¡®çš„å®Œæ•´è·¯å¾„ |
| "æ‰¹æ¬¡ {index} ä¸å­˜åœ¨" | æ‰¹æ¬¡ç´¢å¼•è¶…å‡ºèŒƒå›´ | æ£€æŸ¥æ‰¹æ¬¡ç´¢å¼•èŒƒå›´ï¼ˆä»1å¼€å§‹ï¼‰ |
| "è°ƒåº¦å™¨æœªåˆå§‹åŒ–" | ç³»ç»Ÿç»„ä»¶æœªå°±ç»ª | ç­‰å¾…æˆ–è°ƒç”¨å¥åº·æ£€æŸ¥ç¡®è®¤ç³»ç»ŸçŠ¶æ€ |

---

## å¸¸è§é—®é¢˜

### Q1: plan_idå’Œexecution_idçš„åŒºåˆ«
**A**: 
- `plan_id`: çŒæº‰è®¡åˆ’æ–‡ä»¶çš„è·¯å¾„ï¼Œç”±**ç”Ÿæˆè®¡åˆ’æ¥å£**è¿”å›ï¼Œæ ¼å¼å¦‚ `/app/output/irrigation_plan_20250109_123456.json`
- `execution_id`: æ‰§è¡Œä»»åŠ¡çš„å”¯ä¸€æ ‡è¯†ï¼Œç”±**å¯åŠ¨æ‰§è¡Œæ¥å£**è¿”å›ï¼Œæ ¼å¼å¦‚ `exec_20250109_123456`

**ä½¿ç”¨åœºæ™¯**:
- `plan_id` â†’ ç”¨äºå¯åŠ¨æ‰§è¡Œã€ä¼˜åŒ–ã€é‡æ–°ç”Ÿæˆç­‰éœ€è¦è®¡åˆ’æ–‡ä»¶çš„æ¥å£
- `execution_id` â†’ ç”¨äºæŸ¥è¯¢æ‰§è¡ŒçŠ¶æ€ã€åœæ­¢æ‰§è¡Œç­‰ç®¡ç†æ‰§è¡Œä»»åŠ¡çš„æ¥å£

---

### Q2: è·å– plan_idçš„æ–¹æ³•
**A**: æœ‰ä¸¤ç§æ–¹å¼ï¼š

**æ–¹å¼1: ä»ç”Ÿæˆæ¥å£è·å–**ï¼ˆæ¨èï¼‰
```javascript
const response = await fetch('/api/irrigation/plan-generation', {...});
const data = await response.json();
const planId = data.plan_id; // è¿™å°±æ˜¯plan_id
```
**æ–¹å¼2: ä»æ–‡ä»¶ç³»ç»Ÿè·å–**ï¼ˆä¸æ¨èï¼‰
```
æœ€æ–°è®¡åˆ’æ–‡ä»¶é€šå¸¸åœ¨: /app/output/irrigation_plan_YYYYMMDD_HHMMSS.json
```

---

### Q3: å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯”å’Œè®¡åˆ’ä¼˜åŒ–çš„åŒºåˆ«
**A**: 

| ç‰¹æ€§ | å¤šæ°´æ³µæ–¹æ¡ˆå¯¹æ¯” | è®¡åˆ’ä¼˜åŒ– |
|------|---------------|----------|
| **å¯¹æ¯”ç»´åº¦** | ä¸åŒæ°´æ³µç»„åˆ | ä¸åŒä¼˜åŒ–ç›®æ ‡ |
| **æ–¹æ¡ˆç±»å‹** | P1å•ç‹¬ã€P2å•ç‹¬ã€P1+P2ç»„åˆç­‰ | æˆæœ¬æœ€å°ã€æ—¶é—´æœ€å°ã€å‡è¡¡ã€é¿å³°ç­‰ |
| **ä½¿ç”¨æ—¶æœº** | è®¡åˆ’ç”Ÿæˆæ—¶æˆ–ç‹¬ç«‹è°ƒç”¨ | å·²æœ‰åŸºç¡€è®¡åˆ’åä¼˜åŒ– |
| **æ¥å£** | `/api/irrigation/multi-pump-scenarios` | `/api/irrigation/plan-optimization` |

**æ¨èç”¨æ³•**:
1. å…ˆç”ŸæˆåŸºç¡€è®¡åˆ’ï¼ˆå¯é€‰multi_pump_scenariosï¼‰
2. å¦‚éœ€è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œè°ƒç”¨ä¼˜åŒ–æ¥å£
3. å¯¹æ¯”æ‰€æœ‰æ–¹æ¡ˆï¼Œé€‰æ‹©æœ€ä¼˜

---

### Q4: å®ç°å®æ—¶æ°´ä½æ›´æ–°
**A**: æœ‰ä¸¤ç§æ–¹å¼ï¼š

**æ–¹å¼1: è‡ªåŠ¨æ›´æ–°**ï¼ˆæ¨èï¼‰
```javascript
// å¯åŠ¨æ‰§è¡Œæ—¶å¯ç”¨è‡ªåŠ¨æ°´ä½æ›´æ–°
{
  enable_plan_regeneration: true,
  water_level_update_interval_minutes: 30
}
// ç³»ç»Ÿä¼šè‡ªåŠ¨å®šæœŸè·å–æœ€æ–°æ°´ä½å¹¶é‡æ–°ç”Ÿæˆè®¡åˆ’
```

**æ–¹å¼2: æ‰‹åŠ¨æ›´æ–°**
```javascript
// 1. ä¸»åŠ¨æ¨é€æ°´ä½æ•°æ®
await fetch('/api/water-levels/update', {
  body: JSON.stringify({
    field_id: "S3-G2-F1",
    water_level_mm: 28.5
  })
});

// 2. æ‰‹åŠ¨è§¦å‘é‡æ–°ç”Ÿæˆ
await fetch('/api/regeneration/manual', {
  body: JSON.stringify({
    batch_index: 1,
    force_regeneration: true
  })
});
```

---

### Q5: å¤„ç†æ‰§è¡Œå¤±è´¥

**A**: æ ‡å‡†é”™è¯¯å¤„ç†æµç¨‹ï¼š

```javascript
try {
  const response = await fetch('/api/execution/start', {...});
  
  if (!response.ok) {
    const error = await response.json();
    console.error('æ‰§è¡Œå¤±è´¥:', error.detail);
    
    // æ ¹æ®é”™è¯¯ç±»å‹å¤„ç†
    if (response.status === 404) {
      // è®¡åˆ’æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‡æ–°ç”Ÿæˆè®¡åˆ’
      await generateNewPlan();
    } else if (response.status === 500) {
      // æœåŠ¡å™¨é”™è¯¯ï¼Œè®°å½•å¹¶é€šçŸ¥ç”¨æˆ·
      logError(error.detail);
      notifyUser('ç³»ç»Ÿé”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜');
    }
  }
  
  const data = await response.json();
  // æ­£å¸¸å¤„ç†
  
} catch (error) {
  console.error('ç½‘ç»œé”™è¯¯:', error);
  notifyUser('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ');
}
```

---

### Q6: æ‰¹æ¬¡ç´¢å¼•ä»0å¼€å§‹è¿˜æ˜¯ä»1å¼€å§‹
**A**: **ä»1å¼€å§‹**

```javascript
// æ­£ç¡® âœ…
GET /api/batches/1/details  // è·å–ç¬¬1ä¸ªæ‰¹æ¬¡

// é”™è¯¯ âŒ
GET /api/batches/0/details  // ä¼šè¿”å›404
```

**æ³¨æ„**: 
- APIæ¥å£ä¸­çš„batch_indexï¼š**ä»1å¼€å§‹**
- å†…éƒ¨æ•°ç»„ç´¢å¼•ï¼šä»0å¼€å§‹ï¼ˆå¼€å‘è€…æ— éœ€å…³å¿ƒï¼‰

---

### Q7: æ‰¹æ¬¡é‡æ–°ç”Ÿæˆå’Œæ‰¹æ¬¡é—´ç”°å—è°ƒæ•´çš„åŒºåˆ«

**A**: è¿™ä¸¤ä¸ªæ¥å£è™½ç„¶éƒ½æ¶‰åŠæ‰¹æ¬¡ä¿®æ”¹ï¼Œä½†åº”ç”¨åœºæ™¯å’Œæ•ˆæœå®Œå…¨ä¸åŒï¼š

| ç‰¹æ€§ | æ‰¹æ¬¡é‡æ–°ç”Ÿæˆ<br>`/api/regeneration/batch` | æ‰¹æ¬¡é—´ç”°å—è°ƒæ•´<br>`/api/batch/adjust` |
|------|------------------------------------------|-------------------------------------|
| **ä¸»è¦åŠŸèƒ½** | ä¿®æ”¹ç”°å—æ•°é‡ï¼Œé‡æ–°ç”Ÿæˆæ‰¹æ¬¡ç»“æ„ | åœ¨ç°æœ‰æ‰¹æ¬¡é—´ç§»åŠ¨ç”°å— |
| **æ‰¹æ¬¡æ•°é‡** | âœ… å¯èƒ½æ”¹å˜ | âŒ ä¿æŒä¸å˜ |
| **ç”°å—æ€»æ•°** | âœ… å¯èƒ½æ”¹å˜ï¼ˆå¢åŠ /åˆ é™¤ç”°å—ï¼‰ | âŒ ä¿æŒä¸å˜ |
| **æ‰¹æ¬¡ç»“æ„** | âœ… å¯èƒ½å®Œå…¨é‡æ–°åˆ’åˆ† | âŒ åªè°ƒæ•´åˆ†é… |
| **æ°´æ³µåˆ†é…** | âœ… å¯ä»¥ä¿®æ”¹ | ğŸ”’ é€šå¸¸ä¿æŒä¸å˜ |
| **é€‚ç”¨åœºæ™¯** | â€¢ å¢åŠ æ–°ç”°å—åˆ°è®¡åˆ’<br>â€¢ ç§»é™¤æŸäº›ç”°å—<br>â€¢ å¤§å¹…è°ƒæ•´çŒæº‰èŒƒå›´ | â€¢ ä¼˜åŒ–æ‰¹æ¬¡è´Ÿè½½å‡è¡¡<br>â€¢ è°ƒæ•´çŒæº‰ä¼˜å…ˆçº§<br>â€¢ æ‰¹æ¬¡é—´ç”°å—äº¤æ¢ |
| **è®¡ç®—å¼ºåº¦** | ğŸ”´ é«˜ï¼ˆé‡æ–°è®¡ç®—æ‰¹æ¬¡åˆ’åˆ†ï¼‰ | ğŸŸ¢ ä½ï¼ˆä»…é‡æ–°è®¡ç®—é¡ºåºå’Œæ—¶é—´ï¼‰ |
| **ä½¿ç”¨æ—¶æœº** | è®¡åˆ’å†…å®¹éœ€è¦æ”¹å˜æ—¶ | è®¡åˆ’å†…å®¹ä¸å˜ï¼Œä»…ä¼˜åŒ–åˆ†é…æ—¶ |

**æ¨èä½¿ç”¨åœºæ™¯**:

**ä½¿ç”¨æ‰¹æ¬¡é‡æ–°ç”Ÿæˆ** (`/api/regeneration/batch`)ï¼š
```javascript
// åœºæ™¯1: å¢åŠ æ–°ç”°å—
{
  field_modifications: [
    { field_id: "S3-G10-F30", action: "add", custom_water_level: 95.0 }
  ]
}

// åœºæ™¯2: ç§»é™¤æ•…éšœç”°å—
{
  field_modifications: [
    { field_id: "S3-G5-F3", action: "remove" }
  ]
}

// åœºæ™¯3: ä¿®æ”¹æ°´æ³µåˆ†é…
{
  pump_assignments: [
    { batch_index: 1, pump_ids: ["P1", "P2"] }
  ]
}
```

**ä½¿ç”¨æ‰¹æ¬¡é—´ç”°å—è°ƒæ•´** (`/api/batch/adjust`)ï¼š
```javascript
// åœºæ™¯1: è´Ÿè½½å‡è¡¡ï¼ˆæ‰¹æ¬¡1å¤ªé•¿ï¼Œæ‰¹æ¬¡2å¤ªçŸ­ï¼‰
{
  field_adjustments: [
    { field_id: "S3-G5-F3", from_batch: 1, to_batch: 2 }
  ]
}

// åœºæ™¯2: æé«˜ä¼˜å…ˆçº§ï¼ˆå°†ç”°å—ç§»åˆ°ç¬¬ä¸€æ‰¹æ¬¡ï¼‰
{
  field_adjustments: [
    { field_id: "S5-G27-F19", from_batch: 3, to_batch: 1 }
  ]
}

// åœºæ™¯3: ç”°å—äº¤æ¢
{
  field_adjustments: [
    { field_id: "S3-G5-F3", from_batch: 1, to_batch: 2 },
    { field_id: "S5-G27-F19", from_batch: 2, to_batch: 1 }
  ]
}
```

---

### Q8: è½®è¯¢æ‰§è¡ŒçŠ¶æ€

**A**: æ¨èä½¿ç”¨ä»¥ä¸‹è½®è¯¢ç­–ç•¥ï¼š

```javascript
const pollExecutionStatus = (executionId, onUpdate, onComplete) => {
  let pollInterval;
  
  const checkStatus = async () => {
    try {
      const response = await fetch(
        `/api/execution/status?execution_id=${executionId}`
      );
      const data = await response.json();
      
      // å›è°ƒæ›´æ–°UI
      onUpdate(data.data);
      
      // æ£€æŸ¥æ˜¯å¦å®Œæˆ
      if (data.data.status === 'completed' || 
          data.data.status === 'failed' ||
          data.data.status === 'stopped') {
        clearInterval(pollInterval);
        onComplete(data.data);
      }
    } catch (error) {
      console.error('çŠ¶æ€æŸ¥è¯¢å¤±è´¥:', error);
    }
  };
  
  // åˆå§‹æŸ¥è¯¢
  checkStatus();
  
  // æ¯5ç§’è½®è¯¢ä¸€æ¬¡
  pollInterval = setInterval(checkStatus, 5000);
  
  // è¿”å›åœæ­¢è½®è¯¢çš„å‡½æ•°
  return () => clearInterval(pollInterval);
};

// ä½¿ç”¨ç¤ºä¾‹
const stopPolling = pollExecutionStatus(
  executionId,
  (status) => {
    // æ›´æ–°è¿›åº¦æ¡
    updateProgressBar(status.progress_percent);
    updateCurrentBatch(status.current_batch);
  },
  (finalStatus) => {
    console.log('æ‰§è¡Œå®Œæˆ!', finalStatus);
  }
);
```


## é™„å½•

### A. å®Œæ•´çš„è¯·æ±‚ç¤ºä¾‹ï¼ˆAxiosï¼‰

```javascript
import axios from 'axios';

const api = axios.create({
  baseURL: 'http://120.55.127.125/api',
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json'
  }
});

// è¯·æ±‚æ‹¦æˆªå™¨ï¼ˆå¯æ·»åŠ è®¤è¯ï¼‰
api.interceptors.request.use(config => {
  // æœªæ¥ç‰ˆæœ¬å¯æ·»åŠ  token
  // config.headers.Authorization = `Bearer ${token}`;
  return config;
});

// å“åº”æ‹¦æˆªå™¨ï¼ˆç»Ÿä¸€é”™è¯¯å¤„ç†ï¼‰
api.interceptors.response.use(
  response => response.data,
  error => {
    console.error('API Error:', error.response?.data || error.message);
    return Promise.reject(error.response?.data || error);
  }
);

// ä½¿ç”¨ç¤ºä¾‹
const generatePlan = async () => {
  try {
    const data = await api.post('/irrigation/plan-generation', {
      farm_id: '13944136728576',
      multi_pump_scenarios: true
    });
    return data;
  } catch (error) {
    throw error;
  }
};
```

---

### B. TypeScript ç±»å‹å®šä¹‰

```typescript
// åŸºç¡€å“åº”ç±»å‹
interface ApiResponse<T = any> {
  success: boolean;
  message?: string;
  data?: T;
}

// çŒæº‰è®¡åˆ’å“åº”
interface PlanGenerationResponse {
  success: boolean;
  message: string;
  plan_id: string;
  data: IrrigationPlan;
  multi_pump_scenarios?: MultiPumpScenarios;
}

// çŒæº‰è®¡åˆ’æ•°æ®
interface IrrigationPlan {
  calc: {
    A_cover_mu: number;
    q_avail_m3ph: number;
    t_win_h: number;
    d_target_mm: number;
  };
  batches: Batch[];
  steps: Step[];
}

// æ‰¹æ¬¡æ•°æ®
interface Batch {
  index: number;
  area_mu: number;
  fields: Field[];
  stats: {
    deficit_vol_m3: number;
    cap_vol_m3: number;
    eta_hours: number;
  };
}

// ç”°å—æ•°æ®
interface Field {
  id: string;
  area_mu: number;
  segment_id: string;
  distance_rank: number;
  wl_mm: number;
  inlet_G_id: string;
}

// æ‰§è¡ŒçŠ¶æ€
interface ExecutionStatus {
  execution_id: string;
  status: 'running' | 'paused' | 'completed' | 'failed' | 'stopped';
  start_time: string;
  current_batch: number;
  total_batches: number;
  progress_percent: number;
  total_regenerations: number;
}
```

---

### C. å¿«é€Ÿå‚è€ƒè¡¨

**æ ¸å¿ƒæ¥å£é€ŸæŸ¥**

| åŠŸèƒ½ | æ–¹æ³• | è·¯å¾„ | å…³é”®å‚æ•° | å‚æ•°å«ä¹‰ |
|------|------|------|----------|----------|
| ç”Ÿæˆè®¡åˆ’ | POST | `/api/irrigation/plan-generation` | `farm_id`, `multi_pump_scenarios` | å†œåœºIDï¼Œæ˜¯å¦ç”Ÿæˆå¤šæ–¹æ¡ˆå¯¹æ¯” |
| å¯åŠ¨æ‰§è¡Œ | POST | `/api/execution/start` | `plan_file_path`, `farm_id`, `execution_mode` | è®¡åˆ’æ–‡ä»¶è·¯å¾„ï¼Œå†œåœºIDï¼Œæ‰§è¡Œæ¨¡å¼(æ¨¡æ‹Ÿ/ç”Ÿäº§) |
| æŸ¥è¯¢çŠ¶æ€ | GET | `/api/execution/status` | `execution_id` | æ‰§è¡Œä»»åŠ¡ID |
| å¤šæ³µå¯¹æ¯” | POST | `/api/irrigation/multi-pump-scenarios` | `config_file`, `active_pumps` | é…ç½®æ–‡ä»¶ï¼Œå¯ç”¨æ°´æ³µåˆ—è¡¨ |
| è®¡åˆ’ä¼˜åŒ– | POST | `/api/irrigation/plan-optimization` | `original_plan_id`, `optimization_goals` | åŸå§‹è®¡åˆ’IDï¼Œä¼˜åŒ–ç›®æ ‡åˆ—è¡¨ |
| æ‰¹æ¬¡è¯¦æƒ… | GET | `/api/batches/{index}/details` | `batch_index` | æ‰¹æ¬¡ç´¢å¼•ï¼ˆä»1å¼€å§‹ï¼‰ |
| æ›´æ–°æ°´ä½ | POST | `/api/water-levels/update` | `field_id`, `water_level_mm` | ç”°å—IDï¼Œæ°´ä½å€¼(mm) |
| æ‰¹æ¬¡é—´ç”°å—è°ƒæ•´ | POST | `/api/batch/adjust` | `plan_id`, `field_adjustments`, `options` | è®¡åˆ’IDï¼Œç”°å—è°ƒæ•´åˆ—è¡¨ï¼Œè°ƒæ•´é€‰é¡¹ |

**é‡è¦IDç±»å‹å¯¹ç…§**

| IDç±»å‹ | æ ¼å¼ | ç¤ºä¾‹ | è·å–æ¥æº | ç”¨é€” |
|--------|------|------|----------|------|
| farm_id | æ•°å­—å­—ç¬¦ä¸² | `"13944136728576"` | ç³»ç»Ÿé…ç½® | æ ‡è¯†å†œåœºï¼Œæ‰€æœ‰æ¥å£éƒ½éœ€è¦ |
| plan_id | æ–‡ä»¶è·¯å¾„ | `"/app/output/irrigation_plan_*.json"` | ç”Ÿæˆè®¡åˆ’æ¥å£è¿”å› | å¯åŠ¨æ‰§è¡Œã€ä¼˜åŒ–ã€é‡æ–°ç”Ÿæˆ |
| execution_id | exec_å‰ç¼€ | `"exec_20250109_123456"` | å¯åŠ¨æ‰§è¡Œæ¥å£è¿”å› | æŸ¥è¯¢çŠ¶æ€ã€åœæ­¢æ‰§è¡Œ |
| field_id | S-G-Fæ ¼å¼ | `"S3-G2-F1"` | é…ç½®æ–‡ä»¶ | æ°´ä½æ›´æ–°ã€ç”°å—æ“ä½œ |
| batch_index | æ•´æ•°(â‰¥1) | `1`, `2`, `3` | è®¡åˆ’æ–‡ä»¶ä¸­ | æ‰¹æ¬¡æŸ¥è¯¢ã€æ‰¹æ¬¡ä¿®æ”¹ |

**å¸¸ç”¨å‚æ•°å€¼å¯¹ç…§**

| å‚æ•°å | å¯é€‰å€¼ | è¯´æ˜ | æ¨èå€¼ |
|--------|--------|------|--------|
| execution_mode | `simulation`, `production` | æ¨¡æ‹Ÿæ¨¡å¼ / ç”Ÿäº§æ¨¡å¼ | æµ‹è¯•:`simulation`ï¼Œæ­£å¼:`production` |
| source | `sensor`, `manual`, `estimated` | ä¼ æ„Ÿå™¨ / æ‰‹åŠ¨ / ä¼°ç®— | ä¼˜å…ˆä½¿ç”¨:`sensor` |
| quality | `good`, `fair`, `poor` | è‰¯å¥½ / ä¸€èˆ¬ / è¾ƒå·® | ä¼ æ„Ÿå™¨:`good`ï¼Œäººå·¥:`fair` |
| optimization_goals | `cost_minimization`, `time_minimization`, `balanced`, `off_peak`, `water_saving` | æˆæœ¬ä¼˜å…ˆ / æ—¶é—´ä¼˜å…ˆ / å‡è¡¡ / é¿å³° / èŠ‚æ°´ | æ—¥å¸¸ä½¿ç”¨:`balanced` |




